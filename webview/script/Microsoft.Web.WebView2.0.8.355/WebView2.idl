// Copyright (C) Microsoft Corporation. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

// # API Review
// All APIs need API review. List API review documents here with the URI to the
// doc and the change ID of the IDL when the document was created.
// API documents:
//  * 916246ec [WebView2 API Specification](https://aka.ms/WebView2APISpecification)
//
// # Style
// Follow the [Win32 API Design Guidelines](https://aka.ms/Win32APIDesignGuidelines)
// while editing this file. For any style rules unspecified follow the Anaheim
// style. Specifically, follow Anaheim indenting and line limit style rules in
// this file.
//
// # Documentation
// Please ensure that any new API includes complete documentation in its
// JavaDoc comments in this file and sample usage in the Sample App.
// Comments intended for public API documentation should start with 3 slashes.
// The first sentence is the brief the brief description of the API and
// shouldn't include the name of the API. Use markdown to style your public API
// documentation.
//
// # WebView and JavaScript capitalization
//    camel case  | webViewExample  | javaScriptExample
//    Pascal case | WebViewExample  | JavaScriptExample
//    Upper case  | WEBVIEW_EXAMPLE | JAVASCRIPT_EXAMPLE
//
// That said, in API names use the term 'script' rather than 'JavaScript'.
// Script is shorter and there is only one supported scripting language on the
// web so the specificity of JavaScript is unnecessary.
//
// # URI (not URL)
// We use Uri in parameter names and type names
// throughout. URIs identify resources while URLs (a subset of URIs) also
// locates resources. This difference is not generally well understood. Because
// all URLs are URIs we can ignore the conversation of trying to explain the
// difference between the two and still be technically accurate by always using
// the term URI. Additionally, whether a URI is locatable depends on the context
// since end developers can at runtime specify custom URI scheme resolvers.
//
// # Event pattern
// Events have a method to add and to remove event handlers:
// ```
// HRESULT add_{EventName}(
//     IWebView2{EventName}EventHandler* eventHandler,
//     EventRegistrationToken* token);
//
// HRESULT remove_{EventName}(EventRegistrationToken token);
// ```
// Add takes an event handler delegate interface with a single Invoke method.
// ```
// IWebView2{EventName}EventHandler::Invoke(
//     {SenderType}* sender,
//     IWebView2{EventHandler}EventArgs* args);
// ```
// The Invoke method has two parameters. The first is the sender, the object
// which is firing the event. The second is the EventArgs type. It doesn't take
// the event arg parameters directly so we can version interfaces correctly.
// If the event has no properties on its event args type, then the Invoke method
// should take IUnknown* as its event args parameter so it is possible to add
// event args interfaces in the future without requiring a new event. For events
// with no sender (a static event), the Invoke method has only the event args
// parameter.
//
// # Deferrable event pattern
// Generally, events should be deferrable when their event args have settable
// properties. In order for the caller to use asynchronous methods to produce
// the value for those settable properties we must allow the caller to defer
// the WebView reading those properties until asynchronously later. A deferrable
// event should have the following method on its event args interface:
//   `HRESULT GetDeferral([out, retval] IWebView2Deferral** deferral);`
// If called, the event is deferred and calling Complete on the
// IWebView2Deferral ends the deferral.
//
// # Asynchronous method pattern
// Async methods take a final parameter that is the completed handler:
//   `{MethodName}(..., IWebView2{MethodName}CompletedHandler* handler)`
// The handler has a single Invoke method:
//   `IWebView2{MethodName}CompletedHandler::Invoke(
//       HRESULT errorCode, {AsyncReturnType});`
//
// # Property pattern
// For properties with getters in IDL you have
//   `HRESULT get_{PropertyName}([out, retval] {PropertyType}*)`
// And for properties which also have setters in IDL you have
//   `HRESULT put_{PropertyName}([in] {PropertyType});`
//
// # Versioning
// The loader DLL may be older or newer than the client DLL. We have to deal
// with compatibility across several dimensions:
//  * There's the DLL export contract between the loader DLL and the client
//    DLL as well as the interfaces defined in this IDL that are built into both
//    the app code and the client DLL.
//  * There are two kinds of versioned changes we need to be able to make:
//    compatible changes and breaking changes. In both cases we need to make the
//    change in a safe manner. For compatible that means everything continues to
//    work unchanged despite the loader and client being different versions. For
//    breaking chnages this means the host app is unable to create a
//    WebView using the different version browser and receives an associated
//    error message (doesn't crash).
//  * We also need to consider when the loader and host app is using a newer
//    version than the browser and when the loader and host app is using an
//    older version than the browser.
//
// ## Scenario 1: Older SDK in host app, Newer browser, Compatible change
// In order to be compatible the newer client DLL must still support the older
// client DLL exports. Similarly for the interfaces - they must all be exactly
// the same with no modified IIDs, no reordered methods, no modified method
// parameters etc. The client DLL may have more DLL exports and more interfaces
// but no changes to the older shipped DLL export or interfaces.
// App code doesn't need to do anything special in this case.
//
// ## Scenario 2: Older SDK in host app, Newer browser, Breaking change
// For breaking changes in the DLL export, the client DLL must change the DLL
// export name. The old loader will attempt to use the old client DLL export.
// When the loader finds the export missing it will fail.
// For breaking changes in the interface, we must change the IID of the modified
// interface. Additionally the loader DLL must validate that the returned object
// supports the IID it expects and fail otherwise.
// The app code must ensure that WebView objects succeed in their QueryInterface
// calls. Basically the app code must have error handling for objects failing
// QueryInterface and for the initial creation failing in order to handle
// breaking changes gracefully.
//
// ## Scenario 3: Newer SDK in host app, Older browser, Compatible change
// In order to be compatible, the newer loader DLL must fallback to calling the
// older client DLL exports if the client DLL doesn't have the most recent DLL
// exports.
// For interface versioning the loader DLL shouldn't be impacted.
// The app code must not assume an object supports all newer versioned
// interfaces. Ideally it checks the success of QueryInterface for newer
// interfaces and if not supported turns off associated app features or
// otherwise fails gracefully.
//
// ## Scenario 4: Newer SDK in host app, Older browser, Breaking change
// For breaking changes in the DLL export, a new export name will be used after
// a breaking change and the loader DLL will just not check for pre-breaking
// change exports from the client DLL. If the client DLL doesn't have the
// correct exports, then the loader returns failure to the caller.
// For breaking changes in the interface, the IIDs of broken interfaces will
// have been modified. The loader will validate that the
// object returned supports the correct base interface IID and return failure to
// the caller otherwise.
// The app code must allow for QueryInterface calls to fail if the object
// doesn't support the newer IIDs.
//
// ## Actions
//  * DLL export compatible changes: Create a new DLL export with a new name.
//    Ideally implement the existing DLL export as a call into the new DLL
//    export to reduce upkeep burden.
//  * DLL export breaking changes: Give the modified DLL export a new name and
//    remove all older DLL exports.
//  * Interface compatible changes: Don't modify shipped interfaces. Add a new
//    interface with an incremented version number suffix (IWebView2WebView3)
//    or feature group name suffix (IWebView2WebViewWithNavigationHistory).
//  * Interface breaking changes: After modifying a shipped interface, give it
//    a new IID.
//  * Loader: When finding the client DLL export it must check its known range
//    of compatible exports in order from newest to oldest and use the newest
//    one found. It must not attempt to use an older export from before a
//    breaking change. Before returning objects to the caller, the loader must
//    validate that the object actually implements the expected interface.
//  * App code: Check for error from the DLL export methods as they can fail if
//    the loader is used with an old browser from before a breaking change or
//    with a newer browser that is after a breaking change.
//    Check for errors when calling QueryInterface on a WebView object. The
//    QueryInterface call may fail with E_NOINTERFACE if the object is from an
//    older browser version that doesn't support the newer interface or if
//    using a newer browser version that had a breaking change on that
//    interface.
import "objidl.idl";
import "oaidl.idl";
import "EventToken.idl";

// Interface forward declarations
interface IWebView2AcceleratorKeyPressedEventArgs;
interface IWebView2AcceleratorKeyPressedEventHandler;
interface IWebView2AddScriptToExecuteOnDocumentCreatedCompletedHandler;
interface IWebView2CallDevToolsProtocolMethodCompletedHandler;
interface IWebView2CapturePreviewCompletedHandler;
interface IWebView2DocumentStateChangedEventArgs;
interface IWebView2DocumentStateChangedEventHandler;
interface IWebView2DocumentTitleChangedEventHandler;
interface IWebView2ContainsFullScreenElementChangedEventHandler;
interface IWebView2CreateWebViewCompletedHandler;
interface IWebView2CreateWebView2EnvironmentCompletedHandler;
interface IWebView2Deferral;
interface IWebView2DevToolsProtocolEventReceivedEventArgs;
interface IWebView2DevToolsProtocolEventReceivedEventHandler;
interface IWebView2Environment;
interface IWebView2Environment2;
interface IWebView2Environment3;
interface IWebView2ExecuteScriptCompletedHandler;
interface IWebView2FocusChangedEventHandler;
interface IWebView2HttpHeadersCollectionIterator;
interface IWebView2HttpRequestHeaders;
interface IWebView2HttpResponseHeaders;
interface IWebView2MoveFocusRequestedEventArgs;
interface IWebView2MoveFocusRequestedEventHandler;
interface IWebView2NavigationCompletedEventArgs;
interface IWebView2NavigationCompletedEventHandler;
interface IWebView2NavigationStartingEventArgs;
interface IWebView2NavigationStartingEventHandler;
interface IWebView2NewVersionAvailableEventHandler;
interface IWebView2NewWindowRequestedEventArgs;
interface IWebView2NewWindowRequestedEventHandler;
interface IWebView2PermissionRequestedEventArgs;
interface IWebView2PermissionRequestedEventHandler;
interface IWebView2ProcessFailedEventArgs;
interface IWebView2ProcessFailedEventHandler;
interface IWebView2ScriptDialogOpeningEventArgs;
interface IWebView2ScriptDialogOpeningEventHandler;
interface IWebView2Settings;
interface IWebView2Settings2;
interface IWebView2WebMessageReceivedEventArgs;
interface IWebView2WebMessageReceivedEventHandler;
interface IWebView2WebResourceRequest;
interface IWebView2WebResourceRequestedEventArgs;
interface IWebView2WebResourceRequestedEventHandler;
interface IWebView2WebResourceResponse;
interface IWebView2WebView;
interface IWebView2WebView2;
interface IWebView2WebView3;
interface IWebView2WebView4;
interface IWebView2WebView5;
interface IWebView2ZoomFactorChangedEventHandler;

/// WebView2 enables you to host web content using the
/// latest Edge web browser technology.
///
/// ## Navigation events
/// The normal sequence of navigation events is NavigationStarting,
/// DocumentStateChanged and then NavigationCompleted.
///
/// \dot
/// digraph NavigationEvents {
///    node [fontname=Roboto, shape=rectangle]
///    edge [fontname=Roboto]
///
///    NavigationStarting -> DocumentStateChanged -> NavigationCompleted;
///    NavigationStarting -> NavigationStarting [label="Redirect"];
///    NavigationStarting -> NavigationCompleted [label="Failure"];
/// }
/// \enddot
///
/// Note that this is for navigation events with the same NavigationId event
/// arg. Navigations events with different NavigationId event args may overlap.
/// For instance, if you start a navigation wait for its NavigationStarting
/// event and then start another navigation you'll see the NavigationStarting
/// for the first navigate followed by the NavigationStarting of the second
/// navigate, followed by the NavigationCompleted for the first navigation and
/// then all the rest of the appropriate navigation events for the second
/// navigation.
/// In error cases there may or may not be a DocumentStateChanged event depending
/// on whether the navigation is continued to an error page.
/// In case of an HTTP redirect, there will be multiple NavigationStarting
/// events in a row, with ones following the first will have their IsRedirect
/// flag set.
///
/// For subframes inside WebView, the only navigation event fired is the
/// NavigationStarting event which gives host the ability to block subframe
/// navigations.
///
/// ## Process model
/// WebView2 uses the same process model as the Edge web
/// browser. There is one Edge browser process per specified user data directory
/// in a user session that will serve any WebView2 calling
/// process that specifies that user data directory. This means one Edge browser
/// process may be serving multiple calling processes and one calling
/// process may be using multiple Edge browser processes.
///
/// \dot
/// digraph ProcessModelNClientsNServers {
///     node [fontname=Roboto, shape=rectangle];
///     edge [fontname=Roboto];
///
///     Host1 [label="Calling\nprocess 1"];
///     Host2 [label="Calling\nprocess 2"];
///     Browser1 [label="Edge processes\ngroup 1"];
///     Browser2 [label="Edge processes\ngroup 2"];
///
///     Host1 -> Browser1;
///     Host1 -> Browser2;
///     Host2 -> Browser2;
/// }
/// \enddot
///
/// Off of a browser process there will be some number of renderer processes.
/// These are created as
/// necessary to service potentially multiple frames in different WebViews. The
/// number of renderer processes varies based on the site isolation browser
/// feature and the number of distinct disconnected origins rendered in
/// associated WebViews.
///
/// \dot
/// digraph ProcessModelClientServer {
///     node [fontname=Roboto, shape=rectangle];
///     edge [fontname=Roboto];
///     graph [fontname=Roboto];
///
///     Host [label="Calling process"];
///     subgraph cluster_0 {
///         labeljust = "l";
///         label = "Edge processes group";
///         Browser [label="Edge browser\nprocess"];
///         Render1 [label="Edge render\nprocess 1"];
///         Render2 [label="Edge render\nprocess 2"];
///         RenderN [label="Edge render\nprocess N"];
///         GPU [label="Edge GPU\nprocess"];
///     }
///
///     Host -> Browser;
///     Browser -> Render1;
///     Browser -> Render2;
///     Browser -> RenderN;
///     Browser -> GPU;
/// }
/// \enddot
///
/// You can react to crashes and hangs in these browser and renderer processes
/// using the ProcessFailure event.
///
/// You can safely shutdown associated browser and renderer processes using the
/// Close method.
///
/// ## Threading model
/// The WebView2 must be created on a UI thread. Specifically a
/// thread with a message pump. All callbacks will occur on that thread and
/// calls into the WebView must be done on that thread. It is not safe to use
/// the WebView from another thread.
///
/// Callbacks including event handlers and completion handlers execute serially.
/// That is, if you have an event handler running and begin a message loop no
/// other event handlers or completion callbacks will begin executing
/// reentrantly.
///
/// ## Security
/// Always check the Source property of the WebView before using ExecuteScript,
/// PostWebMessageAsJson, PostWebMessageAsString, or any other method to send
/// information into the WebView. The WebView may have navigated to another page
/// via the end user interacting with the page or script in the page causing
/// navigation. Similarly, be very careful with
/// AddScriptToExecuteOnDocumentCreated. All future navigations will run this
/// script and if it provides access to information intended only for a certain
/// origin, any HTML document may have access.
///
/// When examining the result of an ExecuteScript method call, a
/// WebMessageReceived event, always check the Source of the sender, or any
/// other mechanism of receiving information from an HTML document in a WebView
/// validate the URI of the HTML document is what you expect.
///
/// When constructing a message to send into a WebView, prefer using
/// PostWebMessageAsJson and construct the JSON string parameter using a JSON
/// library. This will avoid any potential accidents of encoding information
/// into a JSON string or script and ensure no attacker controlled input can
/// modify the rest of the JSON message or run arbitrary script.
///
/// ## String types
/// String out parameters are LPWSTR null terminated strings. The callee
/// allocates the string using CoTaskMemAlloc. Ownership is transferred to the
/// caller and it is up to the caller to free the memory using CoTaskMemFree.
///
/// String in parameters are LPCWSTR null terminated strings. The caller ensures
/// the string is valid for the duration of the synchronous function call.
/// If the callee needs to retain that value to some point after the function
/// call completes, the callee must allocate its own copy of the string value.
///
/// ## URI and JSON parsing
/// Various methods provide or accept URIs and JSON as strings. Please use your
/// own preferred library for parsing and generating these strings.
///
/// If WinRT is available for your app you can use `RuntimeClass_Windows_Data_Json_JsonObject`
/// and `IJsonObjectStatics` to parse or produce JSON strings or `RuntimeClass_Windows_Foundation_Uri`
/// and `IUriRuntimeClassFactory` to parse and produce URIs. Both of these work
/// in Win32 apps.
///
/// If you use IUri and CreateUri to parse URIs you may want to use the
/// following URI creation flags to have CreateUri behavior more closely match
/// the URI parsing in the WebView:
/// `Uri_CREATE_ALLOW_IMPLICIT_FILE_SCHEME | Uri_CREATE_NO_DECODE_EXTRA_INFO`
///
/// ## Debugging
/// Open DevTools with the normal shortcuts: `F12` or `Ctrl+Shift+I`.
/// You can use the `--auto-open-devtools-for-tabs` command argument switch to
/// have the DevTools window open immediately when first creating a WebView. See
/// CreateWebView documentation for how to provide additional command line
/// arguments to the browser process.
/// Check out the LoaderOverride registry key for trying out different builds of
/// WebView2 without modifying your application in the CreateWebView
/// documentation.
///
/// ## Versioning
/// After you've used a particular version of the SDK to build your app, your
/// app may end up running with an older or newer version of installed browser
/// binaries. Until version 1.0.0.0 of WebView2 there may be breaking changes
/// during updates that will prevent your SDK from working with different
/// versions of installed browser binaries. After version 1.0.0.0 different
/// versions of the SDK can work with different versions of the installed
/// browser by following these best practices:
///
/// To account for breaking changes to the API be sure to check for failure when
/// calling the DLL export CreateWebView2Environment and when
/// calling QueryInterface on any WebView2 object. A return value of
/// E_NOINTERFACE can indicate the SDK is not compatible with the Edge
/// browser binaries.
///
/// Checking for failure from QueryInterface will also account for cases where
/// the SDK is newer than the version of the Edge browser and your app attempts
/// to use an interface of which the Edge browser is unaware.
///
/// When an interface is unavailable, you can consider disabling the associated
/// feature if possible, or otherwise informing the end user they need to update
/// their browser.
[uuid(76711B9E-8D56-4806-8485-35250BB2384F), object, pointer_default(unique)]
interface IWebView2WebView : IUnknown {
  /// Image format used by the IWebView2WebView::CapturePreview method.
  [v1_enum]
  typedef enum WEBVIEW2_CAPTURE_PREVIEW_IMAGE_FORMAT {
    /// PNG image format.
    WEBVIEW2_CAPTURE_PREVIEW_IMAGE_FORMAT_PNG,
    /// JPEG image format.
    WEBVIEW2_CAPTURE_PREVIEW_IMAGE_FORMAT_JPEG,
  } WEBVIEW2_CAPTURE_PREVIEW_IMAGE_FORMAT;

  /// Kind of JavaScript dialog used in the IWebView2ScriptDialogOpeningEventHandler
  /// interface.
  [v1_enum]
  typedef enum WEBVIEW2_SCRIPT_DIALOG_KIND {
    /// A dialog invoked via the window.alert JavaScript function.
    WEBVIEW2_SCRIPT_DIALOG_KIND_ALERT,
    /// A dialog invoked via the window.confirm JavaScript function.
    WEBVIEW2_SCRIPT_DIALOG_KIND_CONFIRM,
    /// A dialog invoked via the window.prompt JavaScript function.
    WEBVIEW2_SCRIPT_DIALOG_KIND_PROMPT,
  } WEBVIEW2_SCRIPT_DIALOG_KIND;

  /// Kind of process failure used in the IWebView2ProcessFailedEventHandler interface.
  [v1_enum]
  typedef enum WEBVIEW2_PROCESS_FAILED_KIND {
    /// Indicates the browser process terminated unexpectedly.
    /// The WebView automatically goes into the Closed state.
    /// The app has to recreate a new WebView to recover from this failure.
    WEBVIEW2_PROCESS_FAILED_KIND_BROWSER_PROCESS_EXITED,

    /// Indicates the render process terminated unexpectedly.
    /// A new render process will be created automatically and navigated to an
    /// error page.
    /// The app can use Reload to try to recover from this failure.
    WEBVIEW2_PROCESS_FAILED_KIND_RENDER_PROCESS_EXITED,

    /// Indicates the render process becomes unresponsive.
    /// The app can try to navigate away from the page to recover from the
    /// failure.
    // Note that this does not seem to work right now.
    // Does not fire for simple long running script case, the only related test
    // SitePerProcessBrowserTest::NoCommitTimeoutForInvisibleWebContents is
    // disabled.
    WEBVIEW2_PROCESS_FAILED_KIND_RENDER_PROCESS_UNRESPONSIVE,
  } WEBVIEW2_PROCESS_FAILED_KIND;

  /// The type of a permission request.
  [v1_enum]
  typedef enum WEBVIEW2_PERMISSION_TYPE {
    /// Unknown permission.
    WEBVIEW2_PERMISSION_TYPE_UNKNOWN_PERMISSION,

    /// Permission to capture audio.
    WEBVIEW2_PERMISSION_TYPE_MICROPHONE,

    /// Permission to capture video.
    WEBVIEW2_PERMISSION_TYPE_CAMERA,

    /// Permission to access geolocation.
    WEBVIEW2_PERMISSION_TYPE_GEOLOCATION,

    /// Permission to send web notifications.
    /// This permission request is currently auto rejected and
    /// no event is fired for it.
    WEBVIEW2_PERMISSION_TYPE_NOTIFICATIONS,

    /// Permission to access generic sensor.
    /// Generic Sensor covering ambient-light-sensor, accelerometer, gyroscope
    /// and magnetometer.
    WEBVIEW2_PERMISSION_TYPE_OTHER_SENSORS,

    /// Permission to read system clipboard without a user gesture.
    WEBVIEW2_PERMISSION_TYPE_CLIPBOARD_READ,
  } WEBVIEW2_PERMISSION_TYPE;

  /// Response to a permission request.
  [v1_enum]
  typedef enum WEBVIEW2_PERMISSION_STATE {
    /// Use default browser behavior, which normally prompt users for decision.
    WEBVIEW2_PERMISSION_STATE_DEFAULT,

    /// Grant the permission request.
    WEBVIEW2_PERMISSION_STATE_ALLOW,

    /// Deny the permission request.
    WEBVIEW2_PERMISSION_STATE_DENY,
  } WEBVIEW2_PERMISSION_STATE;

  /// Reason for moving focus.
  [v1_enum]
  typedef enum WEBVIEW2_MOVE_FOCUS_REASON {
      /// Code setting focus into WebView.
      WEBVIEW2_MOVE_FOCUS_REASON_PROGRAMMATIC,

      /// Moving focus due to Tab traversal forward.
      WEBVIEW2_MOVE_FOCUS_REASON_NEXT,

      /// Moving focus due to Tab traversal backward.
      WEBVIEW2_MOVE_FOCUS_REASON_PREVIOUS,
  } WEBVIEW2_MOVE_FOCUS_REASON;

  /// Error status values for web navigations.
  [v1_enum]
  typedef enum WEBVIEW2_WEB_ERROR_STATUS {
    /// An unknown error occurred.
    WEBVIEW2_WEB_ERROR_STATUS_UNKNOWN,

    /// The SSL certificate common name does not match the web address.
    WEBVIEW2_WEB_ERROR_STATUS_CERTIFICATE_COMMON_NAME_IS_INCORRECT,

    /// The SSL certificate has expired.
    WEBVIEW2_WEB_ERROR_STATUS_CERTIFICATE_EXPIRED,

    /// The SSL client certificate contains errors.
    WEBVIEW2_WEB_ERROR_STATUS_CLIENT_CERTIFICATE_CONTAINS_ERRORS,

    /// The SSL certificate has been revoked.
    WEBVIEW2_WEB_ERROR_STATUS_CERTIFICATE_REVOKED,

    /// The SSL certificate is invalid.
    WEBVIEW2_WEB_ERROR_STATUS_CERTIFICATE_IS_INVALID,

    /// The host is unreachable.
    WEBVIEW2_WEB_ERROR_STATUS_SERVER_UNREACHABLE,

    /// The connection has timed out.
    WEBVIEW2_WEB_ERROR_STATUS_TIMEOUT,

    /// The server returned an invalid or unrecognized response.
    WEBVIEW2_WEB_ERROR_STATUS_ERROR_HTTP_INVALID_SERVER_RESPONSE,

    /// The connection was aborted.
    WEBVIEW2_WEB_ERROR_STATUS_CONNECTION_ABORTED,

    /// The connection was reset.
    WEBVIEW2_WEB_ERROR_STATUS_CONNECTION_RESET,

    /// The Internet connection has been lost.
    WEBVIEW2_WEB_ERROR_STATUS_DISCONNECTED,

    /// Cannot connect to destination.
    WEBVIEW2_WEB_ERROR_STATUS_CANNOT_CONNECT,

    /// Could not resolve provided host name.
    WEBVIEW2_WEB_ERROR_STATUS_HOST_NAME_NOT_RESOLVED,

    /// The operation was canceled.
    WEBVIEW2_WEB_ERROR_STATUS_OPERATION_CANCELED,

    /// The request redirect failed.
    WEBVIEW2_WEB_ERROR_STATUS_REDIRECT_FAILED,

    /// An unexpected error occurred.
    WEBVIEW2_WEB_ERROR_STATUS_UNEXPECTED_ERROR,
  } WEBVIEW2_WEB_ERROR_STATUS;

/// Enum for web resource request contexts.
[v1_enum]
typedef enum WEBVIEW2_WEB_RESOURCE_CONTEXT {
  /// All resources
  WEBVIEW2_WEB_RESOURCE_CONTEXT_ALL,
  /// Document resources
  WEBVIEW2_WEB_RESOURCE_CONTEXT_DOCUMENT,
  /// CSS resources
  WEBVIEW2_WEB_RESOURCE_CONTEXT_STYLESHEET,
  /// Image resources
  WEBVIEW2_WEB_RESOURCE_CONTEXT_IMAGE,
  /// Other media resources such as videos
  WEBVIEW2_WEB_RESOURCE_CONTEXT_MEDIA,
  /// Font resources
  WEBVIEW2_WEB_RESOURCE_CONTEXT_FONT,
  /// Script resources
  WEBVIEW2_WEB_RESOURCE_CONTEXT_SCRIPT,
  /// XML HTTP requests
  WEBVIEW2_WEB_RESOURCE_CONTEXT_XML_HTTP_REQUEST,
  /// Fetch API communication
  WEBVIEW2_WEB_RESOURCE_CONTEXT_FETCH,
  /// TextTrack resources
  WEBVIEW2_WEB_RESOURCE_CONTEXT_TEXT_TRACK,
  // EventSource API communication
  WEBVIEW2_WEB_RESOURCE_CONTEXT_EVENT_SOURCE,
  // WebSocket API communication
  WEBVIEW2_WEB_RESOURCE_CONTEXT_WEBSOCKET,
  // Web App Manifests
  WEBVIEW2_WEB_RESOURCE_CONTEXT_MANIFEST,
  // Signed HTTP Exchanges
  WEBVIEW2_WEB_RESOURCE_CONTEXT_SIGNED_EXCHANGE,
  // Ping requests
  WEBVIEW2_WEB_RESOURCE_CONTEXT_PING,
  // CSP Violation Reports
  WEBVIEW2_WEB_RESOURCE_CONTEXT_CSP_VIOLATION_REPORT,
  /// Other resources
  WEBVIEW2_WEB_RESOURCE_CONTEXT_OTHER
} WEBVIEW2_WEB_RESOURCE_CONTEXT;

  /// The IWebView2Settings object contains various modifiable settings for
  /// the running WebView.
  HRESULT get_Settings([out, retval] IWebView2Settings** settings);

  /// The URI of the current top level document. This value potentially
  /// changes as a part of the DocumentStateChanged event firing for some cases
  /// such as navigating to a different site or fragment navigations. It will
  /// remain the same for other types of navigations such as page reloads or
  /// history.pushState with the same URL as the current page.
  ///
  /// \snippet ControlComponent.cpp DocumentStateChanged
  HRESULT get_Source([out, retval] LPWSTR* uri);

  /// Cause a navigation of the top level document to the specified URI. See
  /// the navigation events for more information. Note that this starts a
  /// navigation and the corresponding NavigationStarting event will fire
  /// sometime after this Navigate call completes.
  ///
  /// \snippet ControlComponent.cpp Navigate
  HRESULT Navigate([in] LPCWSTR uri);

  /// Move focus into WebView. WebView will get focus and focus will be set to
  /// correspondent element in the page hosted in the WebView.
  /// For Programmatic reason, focus is set to previously focused element or
  /// the default element if there is no previously focused element.
  /// For Next reason, focus is set to the first element.
  /// For Previous reason, focus is set to the last element.
  /// WebView can also got focus through user interaction like clicking into
  /// WebView or Tab into it.
  /// For tabbing, the app can call MoveFocus with Next or Previous to align
  /// with tab and shift+tab respectively when it decides the WebView is the
  /// next tabbable element. Or, the app can call IsDialogMessage as part of
  /// its message loop to allow the platform to auto handle tabbing. The
  /// platform will rotate through all windows with WS_TABSTOP. When the
  /// WebView gets focus from IsDialogMessage, it will internally put the focus
  /// on the first or last element for tab and shift+tab respectively.
  ///
  /// \snippet App.cpp MoveFocus0
  ///
  /// \snippet ControlComponent.cpp MoveFocus1
  ///
  /// \snippet ControlComponent.cpp MoveFocus2
  HRESULT MoveFocus([in] WEBVIEW2_MOVE_FOCUS_REASON reason);

  /// Initiates a navigation to htmlContent as source HTML of a new
  /// document. The htmlContent parameter may not be larger than 2 MB of
  /// characters. The origin of the new page will be about:blank.
  ///
  /// \snippet SettingsComponent.cpp NavigateToString
  HRESULT NavigateToString([in] LPCWSTR htmlContent);

  /// Add an event handler for the NavigationStarting event.
  /// NavigationStarting fires when the WebView main frame is
  /// requesting permission to navigate to a different URI. This will fire for
  /// redirects as well.
  ///
  /// \snippet SettingsComponent.cpp NavigationStarting
  HRESULT add_NavigationStarting(
      [in] IWebView2NavigationStartingEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_NavigationStarting.
  HRESULT remove_NavigationStarting(
      [in] EventRegistrationToken token);

  /// Add an event handler for the DocumentStateChanged event.
  /// DocumentStateChanged fires when new content has started loading
  /// on the webview's main frame or if a same page navigation occurs (such as
  /// through fragment navigations or history.pushState navigations).
  /// This follows the NavigationStarting event and precedes the
  /// NavigationCompleted event.
  ///
  /// \snippet ControlComponent.cpp DocumentStateChanged
  HRESULT add_DocumentStateChanged(
      [in] IWebView2DocumentStateChangedEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_DocumentStateChanged.
  HRESULT remove_DocumentStateChanged(
      [in] EventRegistrationToken token);

  /// Add an event handler for the NavigationCompleted event.
  /// NavigationCompleted event fires when the WebView has completely loaded
  /// (body.onload has fired) or loading stopped with error.
  ///
  /// \snippet ControlComponent.cpp NavigationCompleted
  HRESULT add_NavigationCompleted(
      [in] IWebView2NavigationCompletedEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_NavigationCompleted.
  HRESULT remove_NavigationCompleted(
      [in] EventRegistrationToken token);

  /// Add an event handler for the FrameNavigationStarting event.
  /// FrameNavigationStarting fires when a child frame in the WebView
  /// requesting permission to navigate to a different URI. This will fire for
  /// redirects as well.
  ///
  /// \snippet SettingsComponent.cpp FrameNavigationStarting
  HRESULT add_FrameNavigationStarting(
      [in] IWebView2NavigationStartingEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_FrameNavigationStarting.
  HRESULT remove_FrameNavigationStarting(
      [in] EventRegistrationToken token);

  /// Add an event handler for the MoveFocusRequested event.
  /// MoveFocusRequested fires when user tries to tab out of the WebView.
  /// The WebView's focus has not changed when this event is fired.
  ///
  /// \snippet ControlComponent.cpp MoveFocusRequested
  HRESULT add_MoveFocusRequested(
      [in] IWebView2MoveFocusRequestedEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_MoveFocusRequested.
  HRESULT remove_MoveFocusRequested(
      [in] EventRegistrationToken token);

  /// Add an event handler for the GotFocus event.
  /// GotFocus fires when WebView got focus.
  HRESULT add_GotFocus(
      [in] IWebView2FocusChangedEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_GotFocus.
  HRESULT remove_GotFocus(
      [in] EventRegistrationToken token);

  /// Add an event handler for the LostFocus event.
  /// LostFocus fires when WebView lost focus.
  /// In the case where MoveFocusRequested event is fired, the focus is still
  /// on WebView when MoveFocusRequested event fires. Lost focus only fires
  /// afterwards when app's code or default action of MoveFocusRequested event
  /// set focus away from WebView.
  HRESULT add_LostFocus(
      [in] IWebView2FocusChangedEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_LostFocus.
  HRESULT remove_LostFocus(
      [in] EventRegistrationToken token);

  // TODO: remove this for the next breaking change
  //
  /// This API will be deprecated, please use the new add_WebResourceRequested API
  /// 
  /// Add an event handler for the WebResourceRequested event.
  /// Fires when the WebView has performs any HTTP request.
  /// Use urlFilter to pass in a list with size filterLength of urls to listen
  /// for. Each url entry also supports wildcards: '*' matches zero or more
  /// characters, and '?' matches exactly one character. For each urlFilter
  /// entry, provide a matching resourceContextFilter representing the types of
  /// resources for which WebResourceRequested should fire.
  /// If filterLength is 0, the event will fire for all network requests.
  /// The supported resource contexts are:
  /// Document, Stylesheet, Image, Media, Font, Script, XHR, Fetch.
  ///
  /// \snippet SettingsComponent.cpp WebResourceRequested
  HRESULT add_WebResourceRequested_deprecated(
      [in] LPCWSTR* const urlFilter,
      [in] WEBVIEW2_WEB_RESOURCE_CONTEXT* const resourceContextFilter,
      [in] SIZE_T filterLength,
      [in] IWebView2WebResourceRequestedEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_WebResourceRequested.
  HRESULT remove_WebResourceRequested(
      [in] EventRegistrationToken token);

  /// Add an event handler for the ScriptDialogOpening event.
  /// The event fires when a JavaScript dialog (alert, confirm, or prompt) will
  /// show for the webview. This event only fires if the
  /// IWebView2Settings::AreDefaultScriptDialogsEnabled property is set to false.
  ///
  /// \snippet SettingsComponent.cpp ScriptDialogOpening
  HRESULT add_ScriptDialogOpening(
      [in] IWebView2ScriptDialogOpeningEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_ScriptDialogOpening.
  HRESULT remove_ScriptDialogOpening(
      [in] EventRegistrationToken token);

  /// Add an event handler for the ZoomFactorChanged event.
  /// The event fires when the ZoomFactor property of the WebView changes.
  /// The event could fire because the caller modified the ZoomFactor property,
  /// or due to the user manually modifying the zoom. When it is modified by the
  /// caller via the ZoomFactor property, the internal zoom factor is updated
  /// immediately and there will be no ZoomFactorChanged event.
  /// WebView associates the last used zoom factor for each site. Therefore, it
  /// is possible for the zoom factor to change when navigating to a different
  /// page. When the zoom factor changes due to this, the ZoomFactorChanged
  /// event fires right after the DocumentStateChanged event.
  ///
  /// \snippet ViewComponent.cpp ZoomFactorChanged
  HRESULT add_ZoomFactorChanged(
      [in] IWebView2ZoomFactorChangedEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_ZoomFactorChanged.
  HRESULT remove_ZoomFactorChanged(
      [in] EventRegistrationToken token);

  /// Add an event handler for the PermissionRequested event.
  /// Fires when content in a WebView requests permission to access some
  /// privileged resources.
  ///
  /// \snippet SettingsComponent.cpp PermissionRequested
  HRESULT add_PermissionRequested(
      [in] IWebView2PermissionRequestedEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_PermissionRequested.
  HRESULT remove_PermissionRequested(
      [in] EventRegistrationToken token);

  /// Add an event handler for the ProcessFailed event.
  /// Fires when a WebView process terminated unexpectedly or
  /// become unresponsive.
  ///
  /// \snippet ProcessComponent.cpp ProcessFailed
  HRESULT add_ProcessFailed(
      [in] IWebView2ProcessFailedEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_ProcessFailed.
  HRESULT remove_ProcessFailed(
      [in] EventRegistrationToken token);

  /// Add the provided JavaScript to a list of scripts
  /// that should be executed after the global object has been created, but
  /// before the HTML document has been parsed and before any other script
  /// included by the HTML document is executed. The
  /// injected script will apply to all future top level document and child
  /// frame navigations until removed with RemoveScriptToExecuteOnDocumentCreated.
  /// This is applied asynchronously and you must wait for the completion
  /// handler to run before you can be sure that the script is ready to
  /// execute on future navigations.
  ///
  /// Note that if an HTML document has sandboxing of some kind via [sandbox](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-sandbox)
  /// properties or the [Content-Security-Policy HTTP header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy)
  /// this will affect the script run
  /// here. So, for example, if the 'allow-modals' keyword is not set then calls
  /// to the `alert` function will be ignored.
  ///
  /// \snippet ScriptComponent.cpp AddScriptToExecuteOnDocumentCreated
  HRESULT AddScriptToExecuteOnDocumentCreated(
      [in] LPCWSTR javaScript,
      [in] IWebView2AddScriptToExecuteOnDocumentCreatedCompletedHandler* handler);

  /// Remove the corresponding JavaScript added via AddScriptToExecuteOnDocumentCreated.
  HRESULT RemoveScriptToExecuteOnDocumentCreated([in] LPCWSTR id);

  /// Execute JavaScript code from the javascript parameter in the
  /// current top level document rendered in the WebView. This will execute
  /// asynchronously and when complete, if a handler is provided in the
  /// ExecuteScriptCompletedHandler parameter, its Invoke method will be
  /// called with the result of evaluating the provided JavaScript. The result
  /// value is a JSON encoded string.
  /// If the result is undefined, contains a reference cycle, or otherwise
  /// cannot be encoded into JSON, the JSON null value will be returned as the
  /// string 'null'. Note that a function that has no explicit return value
  /// returns undefined.
  /// If the executed script throws an unhandled exception, then the result is
  /// also 'null'.
  /// This method is applied asynchronously. If the call is made while the
  /// webview is on one document, and a navigation occurs after the call is
  /// made but before the JavaScript is executed, then the script will not be
  /// executed and the handler will be called with E_FAIL for its errorCode
  /// parameter.
  /// ExecuteScript will work even if IsScriptEnabled is set to FALSE.
  ///
  /// \snippet ScriptComponent.cpp ExecuteScript
  HRESULT ExecuteScript(
      [in] LPCWSTR javaScript,
      [in] IWebView2ExecuteScriptCompletedHandler* handler);

  /// Capture an image of what WebView is displaying. Specify the
  /// format of the image with the imageFormat parameter.
  /// The resulting image binary data is written to the provided imageStream
  /// parameter. When CapturePreview finishes writing to the stream, the Invoke
  /// method on the provided handler parameter is called.
  ///
  /// \snippet FileComponent.cpp CapturePreview
  HRESULT CapturePreview(
      [in] WEBVIEW2_CAPTURE_PREVIEW_IMAGE_FORMAT imageFormat,
      [in] IStream* imageStream,
      [in] IWebView2CapturePreviewCompletedHandler* handler);

  /// Reload the current page. This is similar to navigating to the URI of
  /// current top level document including all navigation events firing and
  /// respecting any entries in the HTTP cache. But, the back/forward history
  /// will not be modified.
  HRESULT Reload();

  /// The webview bounds.
  /// Bounds are relative to the parent HWND. The app has two ways it can
  /// position a WebView:
  /// 1. Create a child HWND that is the WebView parent HWND. Position this
  ///    window where the WebView should be. In this case, use (0, 0) for the
  ///    WebView's Bound's top left corner (the offset).
  /// 2. Use the app's top most window as the WebView parent HWND. Set the
  ///    WebView's Bound's top left corner so that the WebView is positioned
  ///    correctly in the app.
  /// The Bound's values are in the host's coordinate space.
  HRESULT get_Bounds([out, retval] RECT* bounds);
  /// Set the Bounds property.
  ///
  /// \snippet ViewComponent.cpp ResizeWebView
  HRESULT put_Bounds([in] RECT bounds);

  /// The zoom factor for the current page in the WebView.
  /// The zoom factor is persisted per site.
  /// Note that changing zoom factor could cause `window.innerWidth/innerHeight`
  /// and page layout to change.
  /// When WebView navigates to a page from a different site,
  /// the zoom factor set for the previous page will not be applied.
  /// If the app wants to set the zoom factor for a certain page, the earliest
  /// place to do it is in the DocumentStateChanged event handler. Note that if it
  /// does that, it might receive a ZoomFactorChanged event for the persisted
  /// zoom factor before receiving the ZoomFactorChanged event for the specified
  /// zoom factor.
  /// Specifying a zoomFactor less than or equal to 0 is not allowed.
  /// WebView also has an internal supported zoom factor range. When a specified
  /// zoom factor is out of that range, it will be normalized to be within the
  /// range, and a ZoomFactorChanged event will be fired for the real
  /// applied zoom factor. When this range normalization happens, the
  /// ZoomFactor property will report the zoom factor specified during the
  /// previous modification of the ZoomFactor property until the
  /// ZoomFactorChanged event is received after webview applies the normalized
  /// zoom factor.
  HRESULT get_ZoomFactor([out, retval] double* zoomFactor);
  /// Set the ZoomFactor property.
  HRESULT put_ZoomFactor([in] double zoomFactor);

  /// The IsVisible property determines whether to show or hide the webview.
  /// If IsVisible is set to false, the webview will be transparent and will
  /// not be rendered.  However, this will not affect the window containing
  /// the webview (the HWND parameter that was passed to CreateWebView).
  /// If you want that window to disappear too, call ShowWindow on it directly
  /// in addition to modifying the IsVisible property.
  /// WebView as a child window won't get window messages when the top window
  /// is minimized or restored. For performance reason, developer should set
  /// IsVisible property of the WebView to false when the app window is
  /// minimized and back to true when app window is restored. App window can do
  /// this by handling SC_MINIMIZE and SC_RESTORE command upon receiving
  /// WM_SYSCOMMAND message.
  ///
  /// \snippet ViewComponent.cpp ToggleIsVisible
  HRESULT get_IsVisible([out, retval] BOOL* isVisible);
  /// Set the IsVisible property.
  ///
  /// \snippet ViewComponent.cpp ToggleIsVisibleOnMinimize
  HRESULT put_IsVisible([in] BOOL isVisible);

  /// Post the specified webMessage to the top level document in this
  /// IWebView2WebView. The top level document's window.chrome.webview's message
  /// event fires. JavaScript in that document may subscribe and unsubscribe to
  /// the event via the following:
  /// ```
  ///    window.chrome.webview.addEventListener('message', handler)
  ///    window.chrome.webview.removeEventListener('message', handler)
  /// ```
  /// The event args is an instance of `MessageEvent`.
  /// The IWebView2Settings::IsWebMessageEnabled setting must be true or this method
  /// will fail with E_INVALIDARG.
  /// The event arg's data property is the webMessage string parameter parsed
  /// as a JSON string into a JavaScript object.
  /// The event arg's source property is a reference to the
  /// `window.chrome.webview` object.
  /// See SetWebMessageReceivedEventHandler for information on sending messages
  /// from the HTML document in the webview to the host.
  /// This message is sent asynchronously. If a navigation occurs before the
  /// message is posted to the page, then the message will not be sent.
  ///
  /// \snippet ScenarioWebMessage.cpp WebMessageReceived
  HRESULT PostWebMessageAsJson([in] LPCWSTR webMessageAsJson);

  /// This is a helper for posting a message that is a simple string
  /// rather than a JSON string representation of a JavaScript object. This
  /// behaves in exactly the same manner as PostWebMessageAsJson but the
  /// `window.chrome.webview` message event arg's data property will be a string
  /// with the same value as webMessageAsString. Use this instead of
  /// PostWebMessageAsJson if you want to communicate via simple strings rather
  /// than JSON objects.
  HRESULT PostWebMessageAsString([in] LPCWSTR webMessageAsString);

  /// This event fires when the IsWebMessageEnabled setting is set and the top
  /// level document of the webview calls `window.chrome.webview.postMessage`.
  /// The postMessage function is `void postMessage(object)` where
  /// object is any object supported by JSON conversion.
  ///
  /// \snippet ScenarioWebMessage.html chromeWebView
  ///
  /// When postMessage is called, the IWebView2WebMessageReceivedEventHandler set via
  /// this SetWebMessageReceivedEventHandler method will be invoked with the
  /// postMessage's object parameter converted to a JSON string.
  ///
  /// \snippet ScenarioWebMessage.cpp WebMessageReceived
  HRESULT add_WebMessageReceived(
      [in] IWebView2WebMessageReceivedEventHandler* handler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_WebMessageReceived.
  HRESULT remove_WebMessageReceived(
      [in] EventRegistrationToken token);

  /// Closes the webview and cleans up the underlying browser instance.
  /// Cleaning up the browser instace will release the resources powering the webview.
  /// The browser instance will be shut down if there are no other webviews using it.
  ///
  /// After calling Close, all method calls will fail and event handlers
  /// will stop firing. Specifically, the WebView will release its references
  /// to its event handlers when Close is called.
  ///
  /// Close is implicitly called when the WebView loses its final reference and
  /// is destructed. But it is best practice to explicitly call Close to avoid
  /// any accidental cycle of references between the WebView and the app code.
  /// Specifically, if you capture a reference to the WebView in an event
  /// handler you will create a reference cycle between the WebView and the
  /// event handler. Close will break this cycle by releasing all event
  /// handlers. But to avoid this situation it is best practice to both
  /// explicitly call Close on the WebView and to not capture a reference to the
  /// WebView to ensure the WebView can be cleaned up correctly.
  ///
  /// \snippet AppWindow.cpp Close
  HRESULT Close();

  /// Call an asynchronous DevToolsProtocol method. See the
  /// [DevTools Protocol Viewer](https://aka.ms/DevToolsProtocolDocs)
  /// for a list and description of available methods.
  /// The methodName parameter is the full name of the method in the format
  /// `{domain}.{method}`.
  /// The parametersAsJson parameter is a JSON formatted string containing
  /// the parameters for the corresponding method.
  /// The handler's Invoke method will be called when the method asynchronously
  /// completes. Invoke will be called with the method's return object as a
  /// JSON string.
  ///
  /// \snippet ScriptComponent.cpp CallDevToolsProtocolMethod
  HRESULT CallDevToolsProtocolMethod(
      [in] LPCWSTR methodName,
      [in] LPCWSTR parametersAsJson,
      [in] IWebView2CallDevToolsProtocolMethodCompletedHandler* handler);

  /// Subscribe to a DevToolsProtocol event. See the
  /// [DevTools Protocol Viewer](https://aka.ms/DevToolsProtocolDocs)
  /// for a list and description of available events.
  /// The eventName parameter is the full name of the event in the format
  /// `{domain}.{event}`.
  /// The handler's Invoke method will be called whenever the corresponding
  /// DevToolsProtocol event fires. Invoke will be called with the
  /// an event args object containing the CDP event's parameter object as a JSON
  /// string.
  ///
  /// \snippet ScriptComponent.cpp DevToolsProtocolEventReceived
  HRESULT add_DevToolsProtocolEventReceived(
      [in] LPCWSTR eventName,
      [in] IWebView2DevToolsProtocolEventReceivedEventHandler* handler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_DevToolsProtocolEventReceived.
  HRESULT remove_DevToolsProtocolEventReceived(
      [in] LPCWSTR eventName,
      [in] EventRegistrationToken token);

  /// The process id of the browser process that hosts the WebView.
  HRESULT get_BrowserProcessId([out, retval] UINT32* value);

  /// Can navigate the webview to the previous page in the navigation history.
  /// get_CanGoBack change value with the DocumentStateChanged event.
  HRESULT get_CanGoBack([out, retval] BOOL* canGoBack);
  /// Can navigate the webview to the next page in the navigation history.
  /// get_CanGoForward change value with the DocumentStateChanged event.
  HRESULT get_CanGoForward([out, retval] BOOL* canGoForward);
  /// Navigates the webview to the previous page in the navigation history.
  HRESULT GoBack();
  /// Navigates the webview to the next page in the navigation history.
  HRESULT GoForward();
}

/// Additional functionality implemented by the primary WebView object.
/// You can QueryInterface for this interface from the object that implements
/// IWebView2WebView. See the IWebView2WebView interface for more details.
[uuid(BB2DA827-0632-4ED6-8EDA-3F9E561767CA), object, pointer_default(unique)]
interface IWebView2WebView2 : IUnknown {
  /// Stop all navigations and pending resource fetches
  HRESULT Stop();
}

/// Additional functionality implemented by the primary WebView object.
/// You can QueryInterface for this interface from the object that implements
/// IWebView2WebView. See the IWebView2WebView interface for more details.
[uuid(A16A5FF1-C23B-4489-8752-8568A1BED09C), object, pointer_default(unique)]
interface IWebView2WebView3 : IWebView2WebView {
  /// Stop all navigations and pending resource fetches
  HRESULT Stop();

  /// Add an event handler for the NewWindowRequested event.
  /// Fires when content inside the WebView requested to open a new window,
  /// such as through window.open. The app can pass a target
  /// webview that will be considered the opened window.
  ///
  /// \snippet AppWindow.cpp NewWindowRequested
  HRESULT add_NewWindowRequested(
      [in] IWebView2NewWindowRequestedEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_NewWindowRequested.
  HRESULT remove_NewWindowRequested(
      [in] EventRegistrationToken token);

  /// Add an event handler for the DocumentTitleChanged event.
  /// The event fires when the DocumentTitle property of the WebView changes
  /// and may fire before or after the NavigationCompleted event.
  ///
  /// \snippet FileComponent.cpp DocumentTitleChanged
  HRESULT add_DocumentTitleChanged(
      [in] IWebView2DocumentTitleChangedEventHandler* eventHandler,
      [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_DocumentTitleChanged.
  HRESULT remove_DocumentTitleChanged(
      [in] EventRegistrationToken token);

  /// The title for the current top level document.
  /// If the document has no explicit title or is otherwise empty,
  /// a default that may or may not match the URI of the document will be used.
  HRESULT get_DocumentTitle([out] LPWSTR* title);
}

/// Additional functionality implemented by the primary WebView object.
/// You can QueryInterface for this interface from the object that implements
/// IWebView2WebView. See the IWebView2WebView interface for more details.
[uuid(E8B04ED2-FA61-4CBB-B303-786088177555), object, pointer_default(unique)]
interface IWebView2WebView4 : IWebView2WebView3 {
  /// Add the provided host object to script running in the WebView with the
  /// specified name.
  /// Host objects are exposed as remote object proxies via
  /// `window.chrome.webview.remoteObjects.<name>`.
  /// Remote object proxies are promises and will resolve to an object
  /// representing the host object.
  /// The promise is rejected if the app has not added an object with the name.
  /// When JavaScript code access a property or method of the object, a promise
  /// is return, which will resolve to the value returned from the host for the
  /// property or method, or rejected in case of error such as there is no such
  /// property or method on the object or parameters are invalid.
  /// For example, when the application code does the following:
  /// ```
  ///    VARIANT object;
  ///    object.vt = VT_DISPATCH;
  ///    object.pdispVal = appObject;
  ///    webview->AddRemoteObject(L"host_object", &host);
  /// ```
  /// JavaScript code in the WebView will be able to access appObject as
  /// following and then access attributes and methods of appObject:
  /// ```
  ///    let app_object = await window.chrome.webview.remoteObjects.host_object;
  ///    let attr1 = await app_object.attr1;
  ///    let result = await app_object.method1(parameters);
  /// ```
  /// Note that while simple types, IDispatch and array are supported, generic
  /// IUnknown, VT_DECIMAL, or VT_RECORD variant is not supported.
  /// Remote JavaScript objects like callback functions are represented as
  /// an VT_DISPATCH VARIANT with the object implementing IDispatch. The
  /// JavaScript callback method may be invoked using DISPID_VALUE for the
  /// DISPID.
  /// Nested arrays are supported up to a depth of 3.
  /// Arrays of by reference types are not supported.
  /// VT_EMPTY and VT_NULL are mapped into JavaScript as null. In JavaScript
  /// null and undefined are mapped to VT_EMPTY.
  ///
  /// Additionally, all remote objects are exposed as
  /// `window.chrome.webview.remoteObjects.sync.<name>`. Here the host
  /// objects are exposed as synchronous remote object proxies. These are not
  /// promises and calls to functions or property access synchronously block
  /// running script waiting to communicate cross process for the host code to
  /// run. Accordingly this can result in reliability issues and it is
  /// recommended that you use the promise based asynchronous
  /// `window.chrome.webview.remoteObjects.<name>` API described above.
  ///
  /// Synchronous remote object proxies and asynchronous remote object proxies
  /// can both proxy the same remote object. Remote changes made by one proxy
  /// will be reflected in any other proxy of that same remote object whether
  /// the other proxies and synchronous or asynchronous.
  ///
  /// While JavaScript is blocked on a synchronous call to native code, that
  /// native code is unable to call back to JavaScript. Attempts to do so will
  /// fail with HRESULT_FROM_WIN32(ERROR_POSSIBLE_DEADLOCK).
  ///
  /// Remote object proxies are JavaScript Proxy objects that intercept all
  /// property get, property set, and method invocations. Properties or methods
  /// that are a part of the Function or Object prototype are run locally.
  /// Additionally any property or method in the array
  /// `chrome.webview.remoteObjects.options.forceLocalProperties` will also be
  /// run locally. This defaults to including optional methods that have
  /// meaning in JavaScript like `toJSON` and `Symbol.toPrimitive`. You can add
  /// more to this array as required.
  ///
  /// There's a method `chrome.webview.remoteObjects.cleanupSome` that will best
  /// effort garbage collect remote object proxies.
  ///
  /// Remote object proxies additionally have the following methods which run
  /// locally:
  ///  * applyRemote, getRemote, setRemote: Perform a method invocation,
  ///    property get, or property set on the remote object. You can use these
  ///    to explicitly force a method or property to run remotely if there is
  ///    a conflicting local method or property. For instance, `proxy.toString()`
  ///    will run the local toString method on the proxy object. But
  ///    ``proxy.applyRemote('toString')`` runs `toString` on the remote proxied
  ///    object instead.
  ///  * getLocal, setLocal: Perform property get, or property set locally. You
  ///    can use these methods to force getting or setting a property on the
  ///    remote object proxy itself rather than on the remote object it
  ///    represents. For instance, `proxy.unknownProperty` will get the
  ///    property named `unknownProperty` from the remote proxied object. But
  ///    ``proxy.getLocal('unknownProperty')`` will get the value of the property
  ///    `unknownProperty` on the proxy object itself.
  ///  * sync: Asynchronous remote object proxies expose a sync method which
  ///    returns a promise for a synchronous remote object proxy for the same
  ///    remote object. For example,
  ///    `chrome.webview.remoteObjects.sample.methodCall()` returns an
  ///    asynchronous remote object proxy. You can use the `sync` method to
  ///    obtain a synchronous remote object proxy instead:
  ///    `const syncProxy = await chrome.webview.remoteObjects.sample.methodCall().sync()`
  ///  * async: Synchronous remote object proxies expose an async method which
  ///    blocks and returns an asynchronous remote object proxy for the same
  ///    remote object. For example, `chrome.webview.remoteObjects.sync.sample.methodCall()` returns a
  ///    synchronous remote object proxy. Calling the `async` method on this blocks
  ///    and then returns an asynchronous remote object proxy for the same remote object:
  ///    `const asyncProxy = chrome.webview.remoteObjects.sync.sample.methodCall().async()`
  ///  * then: Asynchronous remote object proxies have a then method. This
  ///    allows them to be awaitable. `then` will return a promise that resolves
  ///    with a representation of the remote object. If the proxy represents a
  ///    JavaScript literal then a copy of that is returned locally. If
  ///    the proxy represents a function then a non-awaitable proxy is returned.
  ///    If the proxy represents a JavaScript object with a mix of literal
  ///    properties and function properties, then the a copy of the object is
  ///    returned with some properties as remote object proxies.
  ///
  /// All other property and method invocations (other than the above Remote
  /// object proxy methods, forceLocalProperties list, and properties on
  /// Function and Object prototypes) are run remotely. Asynchronous remote
  /// object proxies return a promise representing asynchronous completion of
  /// remotely invoking the method, or getting the property.
  /// The promise resolves after the remote operations complete and
  /// the promises resolve to the resulting value of the operation.
  /// Synchronous remote object proxies work similarly but block JavaScript
  /// execution and wait for the remote operation to complete.
  ///
  /// Setting a property on an asynchronous remote object proxy works slightly
  /// differently. The set returns immediately and the return value is the value
  /// that will be set. This is a requirement of the JavaScript Proxy object.
  /// If you need to asynchronously wait for the property set to complete, use
  /// the setRemote method which returns a promise as described above.
  /// Synchronous object property set property synchronously blocks until the
  /// property is set.
  ///
  /// For example, suppose you have a COM object with the following interface
  ///
  /// \snippet RemoteObjectSample.idl AddRemoteObjectInterface
  ///
  /// We can add an instance of this interface into our JavaScript with
  /// `AddRemoteObject`. In this case we name it `sample`:
  ///
  /// \snippet ScenarioAddRemoteObject.cpp AddRemoteObject
  ///
  /// Then in the HTML document we can use this COM object via `chrome.webview.remoteObjects.sample`:
  ///
  /// \snippet ScenarioAddRemoteObject.html RemoteObjectUsage
  HRESULT AddRemoteObject([in] LPCWSTR name, [in] VARIANT* object);

  /// Remove the host object specified by the name so that it is no longer
  /// accessible from JavaScript code in the WebView.
  /// While new access attempts will be denied, if the object is already
  /// obtained by JavaScript code in the WebView, the JavaScript code will
  /// continue to have access to that object.
  /// Calling this method for a name that is already removed or never added will
  /// fail.
  HRESULT RemoveRemoteObject([in] LPCWSTR name);

  /// Opens the DevTools window for the current document in the WebView.
  /// Does nothing if called when the DevTools window is already open
  HRESULT OpenDevToolsWindow();

  /// The type of key event that triggered an AcceleratorKeyPressed event.
  [v1_enum]
  typedef enum WEBVIEW2_KEY_EVENT_TYPE {
    /// Correspond to window message WM_KEYDOWN.
    WEBVIEW2_KEY_EVENT_TYPE_KEY_DOWN,

    /// Correspond to window message WM_KEYUP.
    WEBVIEW2_KEY_EVENT_TYPE_KEY_UP,

    /// Correspond to window message WM_SYSKEYDOWN.
    WEBVIEW2_KEY_EVENT_TYPE_SYSTEM_KEY_DOWN,

    /// Correspond to window message WM_SYSKEYUP.
    WEBVIEW2_KEY_EVENT_TYPE_SYSTEM_KEY_UP,
  } WEBVIEW2_KEY_EVENT_TYPE;

  /// A structure representing the information packed into the LPARAM given
  /// to a Win32 key event.  See the documentation for WM_KEYDOWN for details
  /// at https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-keydown
  typedef struct WEBVIEW2_PHYSICAL_KEY_STATUS {
    UINT32 RepeatCount;
    UINT32 ScanCode;
    BOOL IsExtendedKey;
    BOOL IsMenuKeyDown;
    BOOL WasKeyDown;
    BOOL IsKeyReleased;
  } WEBVIEW2_PHYSICAL_KEY_STATUS;

  /// Add an event handler for the AcceleratorKeyPressed event.
  /// AcceleratorKeyPressed fires when an accelerator key or key combo is
  /// pressed or released while the WebView is focused. A key is considered an
  /// accelerator if either:
  ///   1. Ctrl or Alt is currently being held, or
  ///   2. the pressed key does not map to a character.
  /// A few specific keys are never considered accelerators, such as Shift.
  /// The Escape key is always considered an accelerator.
  ///
  /// Autorepeated key events caused by holding the key down will also fire this
  /// event.  You can filter these out by checking the event args'
  /// KeyEventLParam or PhysicalKeyStatus.
  ///
  /// In windowed mode, this event handler is called synchronously. Until you
  /// call Handle() on the event args or the event handler returns, the browser
  /// process will be blocked and outgoing cross-process COM calls will fail
  /// with RPC_E_CANTCALLOUT_ININPUTSYNCCALL. All WebView2 API methods will
  /// work, however.
  ///
  /// In windowless mode, the event handler is called asynchronously.  Further
  /// input will not reach the browser until the event handler returns or
  /// Handle() is called, but the browser process itself will not be blocked,
  /// and outgoing COM calls will work normally.
  ///
  /// It is recommended to call Handle(TRUE) as early as you can know that you want
  /// to handle the accelerator key.
  ///
  /// \snippet ControlComponent.cpp AcceleratorKeyPressed
  HRESULT add_AcceleratorKeyPressed(
    [in] IWebView2AcceleratorKeyPressedEventHandler* eventHandler,
    [out] EventRegistrationToken* token);
  /// Remove an event handler previously added with add_AcceleratorKeyPressed.
  HRESULT remove_AcceleratorKeyPressed(
    [in] EventRegistrationToken token);
}

/// Additional functionality implemented by the primary WebView object.
/// You can QueryInterface for this interface from the object that implements
/// IWebView2WebView. See the IWebView2WebView interface for more details.
[uuid(E55144F5-A16F-43D8-9580-1E5227152EDF), object, pointer_default(unique)]
interface IWebView2WebView5 : IWebView2WebView4 {
  /// Notifies when the ContainsFullScreenElement property changes. This means
  /// that an HTML element inside the WebView is entering fullscreen to the size
  /// of the WebView or leaving fullscreen.
  /// This event is useful when, for example, a video element requests to go
  /// fullscreen. The listener of ContainsFullScreenElementChanged can then
  /// resize the WebView in response.
  HRESULT add_ContainsFullScreenElementChanged(
      [in] IWebView2ContainsFullScreenElementChangedEventHandler* eventHandler,
      [out] EventRegistrationToken* token);

  /// Remove an event handler previously added with the corresponding add_
  /// event method.
  HRESULT remove_ContainsFullScreenElementChanged(
      [in] EventRegistrationToken token);

  /// Indicates if the WebView contains a fullscreen HTML element.
  HRESULT get_ContainsFullScreenElement(
      [out, retval] BOOL* containsFullScreenElement);

  /// Add an event handler for the WebResourceRequested event. Fires when the 
  /// WebView is performing an HTTP request to a matching URL and resource context 
  /// filter that was added with AddWebResourceRequestedFilter. At least one 
  /// filter must be added for the event to fire.
  ///
  /// \snippet AppWindow.cpp WebResourceRequested
  HRESULT add_WebResourceRequested(
    [in] IWebView2WebResourceRequestedEventHandler* eventHandler,
    [out] EventRegistrationToken* token);
  
  /// Adds a URI and resource context filter to the WebResourceRequested event.
  /// URI parameter can be a wildcard string ('': zero or more, '?': exactly one). 
  /// nullptr is equivalent to L"".
  /// See WEBVIEW2_WEB_RESOURCE_CONTEXT enum for description of resource context filters.
  HRESULT AddWebResourceRequestedFilter(
    [in] LPCWSTR const uri,
    [in] WEBVIEW2_WEB_RESOURCE_CONTEXT const resourceContext);
  /// Removes a matching WebResource filter that was previously added for the 
  /// WebResourceRequested event. If the same filter was added multiple times, then it
  /// will need to be removed as many times as it was added for the removal to be
  /// effective. Returns E_INVALIDARG for a filter that was never added.
  HRESULT RemoveWebResourceRequestedFilter(
    [in] LPCWSTR const uri,
    [in] WEBVIEW2_WEB_RESOURCE_CONTEXT const resourceContext);
}

/// This interface is used to complete deferrals on event args that
/// support getting deferrals via their GetDeferral method.
[uuid(BD478C19-4706-4B1D-88B6-76DD39ACB7B1), object, pointer_default(unique)]
interface IWebView2Deferral : IUnknown {
  /// Completes the associated deferred event. Complete should only be
  /// called once for each deferral taken.
  HRESULT Complete();
}

/// Defines properties that enable, disable, or modify WebView
/// features. Setting changes made after NavigationStarting event will not
/// apply until the next top level navigation.
[uuid(A28CD108-3234-4B45-B390-7E871B504A96), object, pointer_default(unique)]
interface IWebView2Settings : IUnknown {
  /// Controls if JavaScript execution is enabled in all future
  /// navigations in the WebView.  This only affects scripts in the document;
  /// scripts injected with ExecuteScript will run even if script is disabled.
  /// It is true by default.
  ///
  /// \snippet SettingsComponent.cpp IsScriptEnabled
  HRESULT get_IsScriptEnabled(
      [out, retval] BOOL* isScriptEnabled);
  /// Set the IsScriptEnabled property.
  HRESULT put_IsScriptEnabled([in] BOOL isScriptEnabled);

  /// The IsWebMessageEnabled property is used when loading a new
  /// HTML document. If set to true, communication from the host to the
  /// webview's top level HTML document is allowed via PostWebMessageAsJson,
  /// PostWebMessageAsString, and window.chrome.webview's message event
  /// (see PostWebMessageAsJson documentation for details).
  /// Communication from the webview's top level HTML document
  /// to the host is allowed via window.chrome.webview's postMessage function
  /// and the SetWebMessageReceivedEventHandler method (see the
  /// SetWebMessageReceivedEventHandler documentation for details).
  /// If set to false, then communication is disallowed.
  /// PostWebMessageAsJson and PostWebMessageAsString will
  /// fail with E_ACCESSDENIED and window.chrome.webview.postMessage will fail
  /// by throwing an instance of an Error object.
  /// It is true by default.
  ///
  /// \snippet ScenarioWebMessage.cpp IsWebMessageEnabled
  HRESULT get_IsWebMessageEnabled(
      [out, retval] BOOL* isWebMessageEnabled);
  /// Set the IsWebMessageEnabled property.
  HRESULT put_IsWebMessageEnabled([in] BOOL isWebMessageEnabled);

  /// AreDefaultScriptDialogsEnabled is used when loading a new
  /// HTML document. If set to false, then WebView won't render the default
  /// javascript dialog box (Specifically those shown by the javascript alert,
  /// confirm, and prompt functions). Instead, if an event handler is set by
  /// SetScriptDialogOpeningEventHandler, WebView will send an event that will
  /// contain all of the information for the dialog and allow the host app to
  /// show its own custom UI.
  HRESULT get_AreDefaultScriptDialogsEnabled(
      [out, retval] BOOL* areDefaultScriptDialogsEnabled);
  /// Set the AreDefaultScriptDialogsEnabled property.
  HRESULT put_AreDefaultScriptDialogsEnabled(
      [in] BOOL areDefaultScriptDialogsEnabled);

  // TODO: remove this for the next breaking change:
  // https://microsoft.visualstudio.com/Edge/_workitems/edit/20699378
  //
  /// This setting is deprecated and will always return false. That means
  /// elements in the WebView will only fill the WebView bounds. This property
  /// will then be completely removed. Please listen to the
  /// ContainsFullScreenElementChanged event instead.
  ///
  /// Controls if fullscreen is allowed for elements in the WebView.
  /// When it is allowed, web content such as a video element in the WebView
  /// is allowed to be displayed full screen.
  /// When it is not allowed, such element will fill the WebView bounds when
  /// the element requests full screen.
  /// It is true by default.
  HRESULT get_IsFullscreenAllowed_deprecated(
      [out, retval] BOOL* isFullscreenAllowed);
  /// This setting is deprecated and will have no effect. Please listen to the
  /// ContainsFullScreenElementChanged event instead.
  ///
  /// Set the IsFullscreenAllowed property.
  HRESULT put_IsFullscreenAllowed_deprecated([in] BOOL isFullscreenAllowed);

  /// IsStatusBarEnabled controls whether the status bar will be displayed. The
  /// status bar is usually displayed in the lower left of the WebView and shows
  /// things such as the URI of a link when the user hovers over it and other
  /// information. It is true by default.
  HRESULT get_IsStatusBarEnabled([out, retval] BOOL* isStatusBarEnabled);
  /// Set the IsStatusBarEnabled property.
  HRESULT put_IsStatusBarEnabled([in] BOOL isStatusBarEnabled);

  /// AreDevToolsEnabled controls whether the user is able to use the context
  /// menu or keyboard shortcuts to open the DevTools window.
  /// It is true by default.
  HRESULT get_AreDevToolsEnabled([out, retval] BOOL* areDevToolsEnabled);
  /// Set the AreDevToolsEnabled property.
  HRESULT put_AreDevToolsEnabled([in] BOOL areDevToolsEnabled);
}

/// Defines properties that enable, disable, or modify WebView
/// features. Setting changes made after NavigationStarting event will not
/// apply until the next top level navigation.
[uuid(9FC76F96-CFD8-4C92-8EC5-9215E92EF3E8), object, pointer_default(unique)]
interface IWebView2Settings2 : IWebView2Settings {
  /// The AreDefaultContextMenusEnabled property is used to prevent
  /// default context menus from being shown to user in webview. Defaults to TRUE.
  ///
  /// \snippet SettingsComponent.cpp DisableContextMenu
  HRESULT get_AreDefaultContextMenusEnabled([out, retval] BOOL* enabled);
  /// Set the AreDefaultContextMenusEnabled property
  HRESULT put_AreDefaultContextMenusEnabled([in] BOOL enabled);
}

/// Event args for the ProcessFailed event.
[uuid(6DABCFB8-8C7D-4515-893B-9766766900DA), object, pointer_default(unique)]
interface IWebView2ProcessFailedEventArgs : IUnknown {
  /// The kind of process failure that has occurred.
  HRESULT get_ProcessFailedKind(
      [out, retval] WEBVIEW2_PROCESS_FAILED_KIND* processFailedKind);
}

/// The caller implements this interface to receive ProcessFailed events.
[uuid(011EC830-5DAF-4767-A099-C43DE1A925F4), object, pointer_default(unique)]
interface IWebView2ProcessFailedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IWebView2ProcessFailedEventArgs* args);
}

/// The caller implements this interface to receive ZoomFactorChanged
/// events. Use the IWebView2WebView.ZoomFactor property to get the modified
/// zoom factor.
[uuid(A5C0B08B-25D7-4BAC-AD06-11783393088E), object, pointer_default(unique)]
interface IWebView2ZoomFactorChangedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event. There are no event args and the args
  /// parameter will be null.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IUnknown* args);
}

/// Iterator for a collection of HTTP headers. See IWebView2HttpRequestHeaders
/// and IWebView2HttpResponseHeaders.
[uuid(66a215e4-ca41-490b-884a-411ffb17cd1c), object, pointer_default(unique)]
interface IWebView2HttpHeadersCollectionIterator : IUnknown {
  /// Get the name and value of the current HTTP header of the iterator. This
  /// method will fail if the last call to MoveNext set has_next to FALSE.
  HRESULT GetCurrentHeader([out] LPWSTR* name, [out] LPWSTR* value);
  /// Move the iterator to the next HTTP header in the collection. The has_next
  /// parameter will be set to FALSE if there are no more HTTP headers. After
  /// this occurs the GetCurrentHeader method will fail if called.
  HRESULT MoveNext([out] BOOL* has_next);
}

/// HTTP request headers. Used to inspect the HTTP request on
/// WebResourceRequested event and NavigationStarting event.
/// Note, you can modify the HTTP request headers from a WebResourceRequested event,
/// but not from a NavigationStarting event.
[uuid(982be490-0252-44f3-9f33-376c04885a6d), object, pointer_default(unique)]
interface IWebView2HttpRequestHeaders : IUnknown {
  /// Gets the header value matching the name.
  HRESULT GetHeader([in] LPCWSTR name, [out] LPWSTR* value);
  /// Checks whether the headers contain an entry matching the header name.
  HRESULT Contains([in] LPCWSTR name, [out, retval] BOOL* contains);
  /// Adds or updates header that matches the name.
  HRESULT SetHeader([in] LPCWSTR name, [in] LPCWSTR value);
  /// Removes header that matches the name.
  HRESULT RemoveHeader([in] LPCWSTR name);
  /// Gets an iterator over the collection of request headers.
  HRESULT GetIterator(
  [out] IWebView2HttpHeadersCollectionIterator** iterator);
}

/// HTTP response headers. Used to construct a WebResourceResponse for the
/// WebResourceRequested event.
[uuid(6d1a13a6-c677-41aa-852f-827b53f35301), object, pointer_default(unique)]
interface IWebView2HttpResponseHeaders : IUnknown {
  /// Appends header line with name and value.
  HRESULT AppendHeader([in] LPCWSTR name, [in] LPCWSTR value);
  /// Checks whether the headers contain entries matching the header name.
  HRESULT Contains([in] LPCWSTR name, [out, retval] BOOL* contains);
  /// Gets the header values matching the name.
  HRESULT GetHeaders([in] LPCWSTR name, [out] IWebView2HttpHeadersCollectionIterator** iterator);
  /// Gets an iterator over the collection of entire response headers.
  HRESULT GetIterator(
  [out] IWebView2HttpHeadersCollectionIterator** iterator);
}

/// An HTTP request used with the WebResourceRequested event.
[uuid(1b3f4122-34a0-4f5d-9089-af63c3afe375), object, pointer_default(unique)]
interface IWebView2WebResourceRequest : IUnknown {
  /// The request URI.
  HRESULT get_Uri([out, retval] LPWSTR* uri);
  /// Set the Uri property.
  HRESULT put_Uri([in] LPCWSTR uri);

  /// The HTTP request method.
  HRESULT get_Method([out, retval] LPWSTR* method);
  /// Set the Method property.
  HRESULT put_Method([in] LPCWSTR method);

  /// The HTTP request message body as stream. POST data would be here.
  /// If a stream is set, which will override the message body, the stream must
  /// have all the content data available by the time this
  /// response's WebResourceRequested event deferral is completed. Stream
  /// should be agile or be created from a background STA to prevent performance
  /// impact to the UI thread. Null means no content data. IStream semantics
  /// apply (return S_OK to Read calls until all data is exhausted)
  HRESULT get_Content([out, retval] IStream** content);
  /// Set the Content property.
  HRESULT put_Content([in] IStream* content);

  /// The mutable HTTP request headers
  HRESULT get_Headers([out, retval] IWebView2HttpRequestHeaders** headers);
}

/// An HTTP response used with the WebResourceRequested event.
[uuid(297886a6-5fdf-472d-a97a-e336ecfe1352), object, pointer_default(unique)]
interface IWebView2WebResourceResponse : IUnknown {
  /// HTTP response content as stream. Stream must have all the
  /// content data available by the time this response's WebResourceRequested
  /// event deferral is completed. Stream should be agile or be created from
  /// a background thread to prevent performance impact to the UI thread.
  /// Null means no content data. IStream semantics
  /// apply (return S_OK to Read calls until all data is exhausted)
  HRESULT get_Content([out, retval] IStream** content);
  /// Set the Content property.
  HRESULT put_Content([in] IStream* content);

  /// Overridden HTTP response headers.
  HRESULT get_Headers([out, retval] IWebView2HttpResponseHeaders** headers);

  /// The HTTP response status code.
  HRESULT get_StatusCode([out, retval] int* statusCode);
  /// Set the StatusCode property.
  HRESULT put_StatusCode([in] int statusCode);

  /// The HTTP response reason phrase
  HRESULT get_ReasonPhrase([out, retval] LPWSTR* reasonPhrase);
  /// Set the ReasonPhrase property.
  HRESULT put_ReasonPhrase([in] LPCWSTR reasonPhrase);
}

/// Event args for the NavigationStarting event.
[uuid(9d7a1f73-8211-48c0-9119-686d1fb1ae02), object, pointer_default(unique)]
interface IWebView2NavigationStartingEventArgs : IUnknown {
  /// The uri of the requested navigation.
  HRESULT get_Uri([out, retval] LPWSTR* uri);

  /// True when the navigation was initiated through a user gesture as opposed
  /// to programmatic navigation.
  HRESULT get_IsUserInitiated([out, retval] BOOL* isUserInitiated);

  /// True when the navigation is redirected.
  HRESULT get_IsRedirected([out, retval] BOOL* isRedirected);

  /// The HTTP request headers for the navigation.
  /// Note, you cannot modify the HTTP request headers in a NavigationStarting event.
  HRESULT get_RequestHeaders([out, retval] IWebView2HttpRequestHeaders** requestHeaders);

  /// The host may set this flag to cancel the navigation.
  /// If set, it will be as if the navigation never happened and the current
  /// page's content will be intact. For performance reasons, GET HTTP requests
  /// may happen, while the host is responding. This means cookies can be set
  /// and used part of a request for the navigation.
  HRESULT get_Cancel([out, retval] BOOL* cancel);
  /// Set the Cancel property.
  HRESULT put_Cancel([in] BOOL cancel);
}

/// The caller implements this interface to receive the NavigationStarting
/// event.
[uuid(34896570-DC04-40F9-A2DA-8582551A707D), object, pointer_default(unique)]
interface IWebView2NavigationStartingEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IWebView2NavigationStartingEventArgs* args);
}

/// Event args for the DocumentStateChanged event.
[uuid(3A38CB7F-EFC1-41B4-87FC-5AFCEE27C8ED), object, pointer_default(unique)]
interface IWebView2DocumentStateChangedEventArgs : IUnknown {
  /// True if the page being navigated to is a new document.
  HRESULT get_IsNewDocument([out, retval] BOOL* isNewDocument);

  /// True if the loaded content is an error page.
  HRESULT get_IsErrorPage([out, retval] BOOL* isErrorPage);
}

/// The caller implements this interface to receive the DocumentStateChanged event.
[uuid(88E66305-3A5A-4E7F-9C76-2EBFC138CAFD), object, pointer_default(unique)]
interface IWebView2DocumentStateChangedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IWebView2DocumentStateChangedEventArgs* args);
}

/// Event args for the IWebView2WebView::add_ScriptDialogOpening event.
[uuid(ABB0484E-8D4F-4BEA-9058-B0287221A976), object, pointer_default(unique)]
interface IWebView2ScriptDialogOpeningEventArgs : IUnknown {
  /// The URI of the page that requested the dialog box.
  HRESULT get_Uri([out, retval] LPWSTR* uri);

  /// The kind of JavaScript dialog box.
  HRESULT get_Kind([out, retval] WEBVIEW2_SCRIPT_DIALOG_KIND* kind);

  /// The message of the dialog box. From JavaScript this is the first parameter
  /// passed to alert, confirm, and prompt.
  HRESULT get_Message([out, retval] LPWSTR* message);

  /// The host may call this to respond with OK to confirm and prompt
  /// dialogs or not call this method to indicate cancel. From JavaScript this
  /// means that the confirm function returns true if Accept is called. And
  /// for the prompt function it returns the value of ResultText if Accept is
  /// called and returns false otherwise.
  HRESULT Accept();

  /// The second parameter passed to the JavaScript prompt dialog. This is the
  /// the default value to use for the result of the prompt JavaScript function.
  HRESULT get_DefaultText([out, retval] LPWSTR* defaultText);

  /// The return value from the JavaScript prompt function if Accept is called.
  /// This is ignored for dialog kinds other than prompt. If Accept is not
  /// called this value is ignored and false is returned from prompt.
  HRESULT get_ResultText([out, retval] LPWSTR* resultText);
  /// Set the ResultText property.
  HRESULT put_ResultText([in] LPCWSTR resultText);

  /// GetDeferral can be called to return an IWebView2Deferral object.
  /// You can use this to complete the event at a later time.
  HRESULT GetDeferral([out, retval] IWebView2Deferral** deferral);
}

/// The caller implements this interface to receive the ScriptDialogOpening
/// event.
[uuid(8EAF9A50-2AF9-45DA-9AC5-F80F4147180E), object, pointer_default(unique)]
interface IWebView2ScriptDialogOpeningEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IWebView2ScriptDialogOpeningEventArgs* args);
}

/// Event args for the NavigationCompleted event.
[uuid(48655B1F-3F52-4835-B7AA-7D95F7D7587E), object, pointer_default(unique)]
interface IWebView2NavigationCompletedEventArgs : IUnknown {
  /// True when the navigation is successful. This
  /// is false for a navigation that ended up in an error page (failures due to
  /// no network, DNS lookup failure, HTTP server responds with 4xx), but could
  /// also be false for additional things such as window.stop() called on
  /// navigated page.
  HRESULT get_IsSuccess([out, retval] BOOL* isSuccess);

  /// The error code if the navigation failed.
  HRESULT get_WebErrorStatus([out, retval] WEBVIEW2_WEB_ERROR_STATUS*
      WEBVIEW2_WEB_ERROR_STATUS);
}

/// The caller implements this interface to receive the NavigationCompleted
/// event.
[uuid(DCEB3A27-C8C0-4DE7-889D-AF3DE80EDB3C), object, pointer_default(unique)]
interface IWebView2NavigationCompletedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IWebView2NavigationCompletedEventArgs* args);
}

/// Event args for the PermissionRequested event.
[uuid(8D8DA0E4-A071-486F-85AA-31B4B2BADC61), object, pointer_default(unique)]
interface IWebView2PermissionRequestedEventArgs : IUnknown {
  /// The origin of the web content that requests the permission.
  HRESULT get_Uri([out, retval] LPWSTR* uri);

  /// The type of the permission that is requested.
  HRESULT get_PermissionType([out, retval] WEBVIEW2_PERMISSION_TYPE* value);

  /// True when the permission request was initiated through a user gesture.
  /// Note that being initiated through a user gesture doesn't mean that user
  /// intended to access the associated resource.
  HRESULT get_IsUserInitiated([out, retval] BOOL* isUserInitiated);

  /// The status of a permission request, i.e. whether the request is granted.
  /// Default value is WEBVIEW2_PERMISSION_STATE_DEFAULT.
  HRESULT get_State([out, retval] WEBVIEW2_PERMISSION_STATE* value);
  /// Set the State property.
  HRESULT put_State([in] WEBVIEW2_PERMISSION_STATE value);

  /// GetDeferral can be called to return an IWebView2Deferral object.
  /// Developer can use the deferral object to make the permission decision
  /// at a later time.
  HRESULT GetDeferral([out, retval] IWebView2Deferral** deferral);
}

/// The caller implements this interface to receive the PermissionRequested
/// event.
[uuid(C5DA3C20-95AC-4345-B3C9-5FCA3B92C9DB), object, pointer_default(unique)]
interface IWebView2PermissionRequestedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IWebView2PermissionRequestedEventArgs* args);
}

/// The caller implements this interface to receive the result of the
/// AddScriptToExecuteOnDocumentCreated method.
[uuid(EE07AA7F-5DAF-4C00-9C0B-5F736213C92D), object, pointer_default(unique)]
interface IWebView2AddScriptToExecuteOnDocumentCreatedCompletedHandler : IUnknown {
  /// Called to provide the implementer with the completion status and result
  /// of the corresponding asynchronous method call.
  HRESULT Invoke([in] HRESULT errorCode, [in] LPCWSTR id);
}

/// The caller implements this interface to receive the result of the
/// ExecuteScript method.
[uuid(F5AC0E3B-8B92-45E5-ABEF-DB8518EFFF27), object, pointer_default(unique)]
interface IWebView2ExecuteScriptCompletedHandler : IUnknown {
  /// Called to provide the implementer with the completion status and result
  /// of the corresponding asynchronous method call.
  HRESULT Invoke([in] HRESULT errorCode, [in] LPCWSTR resultObjectAsJson);
}

/// Event args for the WebResourceRequested event.
[uuid(D8B1DD71-B9AD-4EEB-ABE3-87E7EFC5D37F), object, pointer_default(unique)]
interface IWebView2WebResourceRequestedEventArgs : IUnknown
{
  /// The HTTP request.
  HRESULT get_Request([out, retval] IWebView2WebResourceRequest** request);

  /// The HTTP response.
  HRESULT get_Response([out, retval] IWebView2WebResourceResponse** response);
  /// Set the Response property.
  HRESULT put_Response([in] IWebView2WebResourceResponse* response);

  /// Obtain an IWebView2Deferral object and put the event into a deferred state.
  /// You can use the IWebView2Deferral object to complete the network request at a
  /// later time.
  HRESULT GetDeferral([out, retval] IWebView2Deferral** deferral);
}

[uuid(b38f6f16-9568-4f12-9996-dca7a06299f4), object, pointer_default(unique)]
interface IWebView2WebResourceRequestedEventArgs2 : IWebView2WebResourceRequestedEventArgs {
  HRESULT get_ResourceContext(WEBVIEW2_WEB_RESOURCE_CONTEXT* context);
}

/// Fires when an HTTP request is made in the webview. The host can override
/// request, response headers and response content.
[uuid(E2AE08C1-4F67-4348-AE05-C89CB14C2ADD), object, pointer_default(unique)]
interface IWebView2WebResourceRequestedEventHandler : IUnknown
{
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IWebView2WebResourceRequestedEventArgs* args);
}

/// The caller implements this method to receive the result of the
/// CapturePreview method. The result is written to the stream provided in
/// the CapturePreview method call.
[uuid(5755B27A-3FCD-4E01-B368-06834A5AFCDC), object, pointer_default(unique)]
interface IWebView2CapturePreviewCompletedHandler : IUnknown {
  /// Called to provide the implementer with the completion status
  /// of the corresponding asynchronous method call.
  HRESULT Invoke([in] HRESULT result);
}

/// The caller implements this method to receive the GotFocus and LostFocus
/// events. There are no event args for this event.
[uuid(76BDBECE-02CC-4E56-AD81-5F808E8572A6), object, pointer_default(unique)]
interface IWebView2FocusChangedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event. There are no event args and the args
  /// parameter will be null.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IUnknown* args);
}

/// Event args for the MoveFocusRequested event.
[uuid(64AF5AE3-27A1-47E0-8901-95119C1BA95B), object, pointer_default(unique)]
interface IWebView2MoveFocusRequestedEventArgs : IUnknown {
  /// The reason for WebView to fire the MoveFocus Requested event.
  HRESULT get_Reason([out, retval] WEBVIEW2_MOVE_FOCUS_REASON* value);

  /// Indicate whether the event has been handled by the app.
  /// If the app has moved the focus to its desired location, it should set
  /// Handled property to TRUE.
  /// When Handled property is false after the event handler returns, default
  /// action will be taken. The default action is to try to find the next tab
  /// stop child window in the app and try to move focus to that window. If
  /// there is no other such window to move focus to, focus will be cycled
  /// within the WebView's web content.
  HRESULT get_Handled([out, retval] BOOL* value);
  /// Set the Handled property.
  HRESULT put_Handled([in] BOOL value);
}

/// The caller implements this method to receive the MoveFocusRequested event.
[uuid(F3A49DD0-EA49-469C-8B7A-8CC5E8E4EF27), object, pointer_default(unique)]
interface IWebView2MoveFocusRequestedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IWebView2MoveFocusRequestedEventArgs* args);
}

/// Event args for the WebMessageReceived event.
[uuid(E32C6167-14F1-42EA-8743-B014EF6AD27F), object, pointer_default(unique)]
interface IWebView2WebMessageReceivedEventArgs : IUnknown {
  /// The URI of the document that sent this web message.
  HRESULT get_Source([out, retval] LPWSTR* source);

  /// The message posted from the webview content to the host converted to a
  /// JSON string. Use this to communicate via JavaScript objects.
  ///
  /// For example the following postMessage calls result in the
  /// following WebMessageAsJson values:
  ///
  /// ```
  ///    postMessage({'a': 'b'})      L"{\"a\": \"b\"}"
  ///    postMessage(1.2)             L"1.2"
  ///    postMessage('example')       L"\"example\""
  /// ```
  HRESULT get_WebMessageAsJson([out, retval] LPWSTR* webMessageAsJson);

  /// If the message posted from the webview content to the host is a
  /// string type, this method will return the value of that string. If the
  /// message posted is some other kind of JavaScript type this method will fail
  /// with E_INVALIDARG. Use this to communicate via simple strings.
  ///
  /// For example the following postMessage calls result in the
  /// following WebMessageAsString values:
  ///
  /// ```
  ///    postMessage({'a': 'b'})      E_INVALIDARG
  ///    postMessage(1.2)             E_INVALIDARG
  ///    postMessage('example')       L"example"
  /// ```
  HRESULT get_WebMessageAsString([out, retval] LPWSTR* webMessageAsString);
}

/// The caller implements this interface to receive the WebMessageReceived
/// event.
[uuid(0E682B9A-B686-4327-9A56-E0305705A3DB), object, pointer_default(unique)]
interface IWebView2WebMessageReceivedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2WebView* webview,
                 [in] IWebView2WebMessageReceivedEventArgs* args);
}

/// Event args for the DevToolsProtocolEventReceived event.
[uuid(BF0F875F-8EB0-4211-9B80-2892F7276BB9), object, pointer_default(unique)]
interface IWebView2DevToolsProtocolEventReceivedEventArgs : IUnknown {
  /// The parameter object of the corresponding DevToolsProtocol event
  /// represented as a JSON string.
  HRESULT get_ParameterObjectAsJson([out, retval] LPWSTR*
                                    parameterObjectAsJson);
}

/// The caller implements this interface to receive
/// DevToolsProtocolEventReceived events from the IWebView2WebView.
[uuid(37D087EA-12F6-4856-81D8-5596C708CA59), object, pointer_default(unique)]
interface IWebView2DevToolsProtocolEventReceivedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IWebView2DevToolsProtocolEventReceivedEventArgs* args);
}

/// The caller implements this interface to receive CallDevToolsProtocolMethod
/// completion results.
[uuid(6EA28F62-FEC5-48EA-9669-67979B50579E), object, pointer_default(unique)]
interface IWebView2CallDevToolsProtocolMethodCompletedHandler : IUnknown {
  /// Called to provide the implementer with the completion status and result
  /// of the corresponding asynchronous method call.
  HRESULT Invoke([in] HRESULT errorCode, [in] LPCWSTR returnObjectAsJson);
}

/// The caller implements this interface to receive the WebView created
/// via CreateWebView.
[uuid(E0618CDD-4947-4F58-802C-FC1F20BD4274), object, pointer_default(unique)]
interface IWebView2CreateWebViewCompletedHandler : IUnknown {
  /// Called to provide the implementer with the completion status and result
  /// of the corresponding asynchronous method call.
  HRESULT Invoke(HRESULT result, IWebView2WebView* webView);
}

/// Event args for the NewWindowRequested event. The event is fired when content
/// inside webview requested to a open a new window (through window.open() etc.)
[uuid(1f6e4074-bc3d-4381-ba8a-cf65feaa036a), object, pointer_default(unique)]
interface IWebView2NewWindowRequestedEventArgs : IUnknown
{
  /// The target uri of the NewWindowRequest.
  HRESULT get_Uri([out, retval] LPWSTR* uri);

  /// Sets a WebView as a result of the NewWindowRequest. The target
  /// webview should not be navigated. If the NewWindow is set, its top level
  /// window will return as the opened WindowProxy.
  HRESULT put_NewWindow([in] IWebView2WebView* newWindow);
  /// Gets the new window.
  HRESULT get_NewWindow([out, retval] IWebView2WebView** newWindow);

  /// Sets whether the NewWindowRequestedEvent is handled by host. If this is false
  /// and no NewWindow is set, the WebView will open a popup
  /// window and it will be returned as opened WindowProxy.
  /// If set to true and no NewWindow is set for a window.open call, the opened
  /// WindowProxy will be for an dummy window object and no window will load.
  /// Default is false.
  HRESULT put_Handled([in] BOOL handled);
  /// Gets whether the NewWindowRequestedEvent is handled by host.
  HRESULT get_Handled([out, retval] BOOL* handled);

  /// IsUserInitiated is true when the new window request was initiated through a user gesture
  /// such as clicking an anchor tag with target.
  HRESULT get_IsUserInitiated([out, retval] BOOL* isUserInitiated);

  /// Obtain an IWebView2Deferral object and put the event into a deferred state.
  /// You can use the IWebView2Deferral object to complete the window open
  /// request at a later time.
  /// While this event is deferred the opener window will be returned a WindowProxy
  /// to an unnavigated window, which will navigate when the deferral is complete.
  HRESULT GetDeferral([out, retval] IWebView2Deferral** deferral);
}

/// The caller implements this interface to receive NewWindowRequested
/// events.
[uuid(1daa050a-98de-44ad-b5bb-935c8b9c7c0b), object, pointer_default(unique)]
interface IWebView2NewWindowRequestedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IWebView2NewWindowRequestedEventArgs* args);
}

/// The caller implements this interface to receive DocumentTitleChanged
/// events. Use the DocumentTitle property to get the modified
/// title.
[uuid(E190F4F4-7C94-4CB3-BA4D-DDCDA7AC7693), object, pointer_default(unique)]
interface IWebView2DocumentTitleChangedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event. There are no event args and the args
  /// parameter will be null.
  HRESULT Invoke([in] IWebView2WebView3* webview, [in] IUnknown* args);
}

/// Event args for the AcceleratorKeyPressed event.
[uuid(64C29E6D-BA57-4EBA-A14F-71697F4F3D86), object, pointer_default(unique)]
interface IWebView2AcceleratorKeyPressedEventArgs : IUnknown {
  /// The key event type that caused the event to be fired. This is one of
  /// WEBVIEW2_KEY_EVENT_TYPE_KEY_DOWN, WEBVIEW2_KEY_EVENT_TYPE_KEY_UP,
  /// WEBVIEW2_KEY_EVENT_TYPE_SYSTEM_KEY_DOWN, or
  /// WEBVIEW2_KEY_EVENT_TYPE_SYSTEM_KEY_UP.
  HRESULT get_KeyEventType([out, retval] WEBVIEW2_KEY_EVENT_TYPE* keyEventType);
  /// The Win32 virtual key code of the key that was pressed or released.
  /// This will be one of the Win32 virtual key constants such as VK_RETURN or
  /// an (uppercase) ASCII value such as 'A'. You can check whether Ctrl or Alt
  /// are pressed by calling GetKeyState(VK_CONTROL) or GetKeyState(VK_MENU).
  HRESULT get_VirtualKey([out, retval] UINT* virtualKey);
  /// The LPARAM value that accompanied the window message. See the
  /// documentation for the WM_KEYDOWN and WM_KEYUP messages.
  HRESULT get_KeyEventLParam([out, retval] INT* lParam);
  /// A structure representing the information passed in the LPARAM of the
  /// window message.
  HRESULT get_PhysicalKeyStatus(
      [out, retval] WEBVIEW2_PHYSICAL_KEY_STATUS* physicalKeyStatus);
  /// Calling this will allow the browser process to continue. Passing TRUE will
  /// prevent the browser from performing the default action for this
  /// accelerator key. If the event handler returns without calling Handle(),
  /// it is equivalent to calling Handle(FALSE). Calling Handle() after it has
  /// already been called or the event handler has returned will do nothing.
  HRESULT Handle([in] BOOL handled);
}

/// The caller implements this interface to receive the AcceleratorKeyPressed
/// event.
[uuid(53E3676B-287C-4967-B7E2-DA0448BEB0F1), object, pointer_default(unique)]
interface IWebView2AcceleratorKeyPressedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2WebView* webview, [in] IWebView2AcceleratorKeyPressedEventArgs* args);
}

/// Event args for the NewVersionAvailable event.
[uuid(0256DA7B-2BF7-4B12-8ECA-EFFCB28C2CD8), object, pointer_default(unique)]
interface IWebView2NewVersionAvailableEventArgs : IUnknown {
  /// The browser version info of the current IWebView2Environment
  HRESULT get_NewVersion([out, retval] LPWSTR* newVersion);
}

/// The caller implements this interface to receive NewVersionAvailable events.
/// Use the get_NewVersion method of IWebView2NewVersionAvailableEventArgs
/// to get the new version number.
[uuid(9E21312F-6FE7-4118-8CA1-6317C9CD627B), object, pointer_default(unique)]
interface IWebView2NewVersionAvailableEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event.
  HRESULT Invoke([in] IWebView2Environment* webviewEnvironment,
                 [in] IWebView2NewVersionAvailableEventArgs* args);
}

/// The caller implements this method to receive the
/// ContainsFullScreenElementChanged events. There are no event args for this
/// event.
[uuid(37CF6A21-4B0C-41B6-81A6-C85C0D0A7543), object, pointer_default(unique)]
interface IWebView2ContainsFullScreenElementChangedEventHandler : IUnknown {
  /// Called to provide the implementer with the event args for the
  /// corresponding event. There are no event args and the args
  /// parameter will be null.
  HRESULT Invoke([in] IWebView2WebView5* webview, [in] IUnknown* args);
}

/// This represents the WebView2 Environment. WebViews created from an
/// environment run on the Browser process specified with environment parameters
/// and objects created from an environment should be used in the same environment.
/// Using it in different environments are not guaranteed to be compatible and may fail.
[uuid(33D17ECE-82FA-47D9-8978-CD17FF3C3CC6), object, pointer_default(unique)]
interface IWebView2Environment : IUnknown {
  /// Asynchronously create a new IWebView2WebView.
  ///
  /// parentWindow is the HWND in which the WebView should be displayed and
  /// from which receive input. The WebView will add a child window to the
  /// provided window during WebView creation. Z-order and other things impacted
  /// by sibling window order will be affected accordingly.
  ///
  /// It is recommended that the application set Application User Model ID for
  /// the process or the application window. If none is set, during WebView
  /// creation a generated Application User Model ID is set to root window of
  /// parentWindow.
  /// \snippet AppWindow.cpp CreateWebView
  ///
  /// It is recommended that the application handles restart manager messages
  /// so that it can be restarted gracefully in the case when the app is using
  /// Edge for webview from a certain installation and that installation is being
  /// uninstalled. For example, if a user installs Edge from Dev channel and
  /// opts to use Edge from that channel for testing the app, and then uninstalls
  /// Edge from that channel without closing the app, the app will be restarted
  /// to allow uninstallation of the dev channel to succeed.
  /// \snippet AppWindow.cpp RestartManager
  HRESULT CreateWebView(
    HWND parentWindow,
    IWebView2CreateWebViewCompletedHandler* handler);

  /// Create a new web resource response object. The headers is the
  /// raw response header string delimited by newline. It's also possible to
  /// create this object with empty headers string and then use the
  /// IWebView2HttpResponseHeaders to construct the headers line by line.
  /// For information on other parameters see IWebView2WebResourceResponse.
  ///
  /// \snippet SettingsComponent.cpp WebResourceRequested
  HRESULT CreateWebResourceResponse(
    IStream* content,
    int statusCode,
    LPCWSTR reasonPhrase,
    LPCWSTR headers,
    IWebView2WebResourceResponse** response);
}

/// Additional functionality implemented by the Environment object. See the
/// IWebView2Environment interface for more details. You can QueryInterface
/// for this interface from the object that implements IWebView2Environment.
[uuid(013124F3-02FD-4DFF-8911-06016AF1E3EE), object, pointer_default(unique)]
interface IWebView2Environment2 : IWebView2Environment {
  /// The browser version info of the current IWebView2Environment,
  /// including channel name if it is not the stable channel.
  /// This matches the format of the GetWebView2BrowserVersionInfo API.
  /// Channel names are 'beta', 'dev', and 'canary'.
  ///
  /// \snippet AppWindow.cpp GetBrowserVersionInfo
  HRESULT get_BrowserVersionInfo([out, retval] LPWSTR* versionInfo);
}

/// Additional functionality implemented by the Environment object. See the
/// IWebView2Environment interface for more details. You can QueryInterface
/// for this interface from the object that implements IWebView2Environment.
[uuid(D82C6A26-370F-4084-8149-C08FF1598C9B), object, pointer_default(unique)]
interface IWebView2Environment3 : IWebView2Environment2 {
    /// The NewVersionAvailable event fires when a newer version of the
    /// Edge browser is installed and available to use via WebView2.
    /// To use the newer version of the browser you must create a new
    /// IWebView2Environment and IWebView2WebView.
    /// Event will only be fired for new version from the same Edge channel
    /// that the code is running from. When not running with installed Edge,
    /// no event will be fired.
    ///
    /// Because a user data folder can only be used by one browser process at
    /// a time, if you want to use the same user data folder in the WebViews
    /// using the new version of the browser,
    /// you must close the IWebView2Environment and IWebView2WebViews
    /// that are using the older version of the browser first.
    /// Or simply prompt the user to restart the app.
    ///
    /// \snippet AppWindow.cpp NewVersionAvailable
    ///
    HRESULT add_NewVersionAvailable(
        [in] IWebView2NewVersionAvailableEventHandler* eventHandler,
        [out] EventRegistrationToken* token);

    /// Remove an event handler previously added with add_NewVersionAvailable.
    HRESULT remove_NewVersionAvailable(
        [in] EventRegistrationToken token);
}

/// The caller implements this interface to receive the WebView2Environment created
/// via CreateWebView2Environment.
[uuid(A8346945-51C2-4CE6-8B4C-6F3C4391828B), object, pointer_default(unique)]
interface IWebView2CreateWebView2EnvironmentCompletedHandler : IUnknown {
  /// Called to provide the implementer with the completion status and result
  /// of the corresponding asynchronous method call.
  HRESULT Invoke(HRESULT result, IWebView2Environment* webViewEnvironment);
}

/// DLL export to create a WebView2 environment with a custom version of Edge,
/// user data directory and/or additional browser switches.
///
/// browserExecutableFolder is the relative path to the folder that
/// contains the embedded Edge. The embedded Edge can be obtained by
/// copying the version named folder of an installed Edge, like
/// 73.0.52.0 sub folder of an installed 73.0.52.0 Edge. The folder
/// should have msedge.exe, msedge.dll, etc.
/// Use null or empty string for browserExecutableFolder to create
/// WebView using Edge installed on the machine, in which case the
/// API will try to find a compatible version of Edge installed on the
/// machine according to the channel preference trying to find first
/// per user install and then per machine install.
///
/// The default channel search order is stable, beta, dev, and canary.
/// When there is an override WEBVIEW2_RELEASE_CHANNEL_PREFERENCE environment
/// variable or applicable releaseChannelPreference registry value
/// with the value of 1, the channel search order is reversed.
///
/// userDataFolder can be
/// specified to change the default user data folder location for
/// WebView2. The path can be an absolute file path or a relative file path
/// that is interpreted as relative to the current process's executable.
/// Otherwise, for UWP apps, the default user data folder will be
/// the app data folder for the package; for non-UWP apps,
/// the default user data folder `{Executable File Name}.WebView2`
/// will be created in the same directory next to the app executable.
/// WebView2 creation can fail if the executable is running in a directory
/// that the process doesn't have permission to create a new folder in.
/// The app is responsible to clean up its user data folder
/// when it is done.
///
/// additionalBrowserArguments can be specified to change the behavior of the
/// WebView. These will be passed to the browser process as part of
/// the command line. See
/// [Run Chromium with Flags](https://aka.ms/RunChromiumWithFlags)
/// for more information about command line switches to browser
/// process. If the app is launched with a command line switch
/// `--edge-webview-switches=xxx` the value of that switch (xxx in
/// the above example) will also be appended to the browser
/// process command line. Certain switches like `--user-data-dir` are
/// internal and important to WebView. Those switches will be
/// ignored even if specified. If the same switches are specified
/// multiple times, the last one wins. Note that this also applies
/// to switches like `--enable-features`. There is no attempt to
/// merge the different values of the same switch. App process's
/// command line `--edge-webview-switches` value are processed after
/// the additionalBrowserArguments parameter is processed.
/// Also note that as a browser process might be shared among
/// WebViews, the switches are not guaranteed to be applied except
/// for the first WebView that starts the browser process.
/// If parsing failed for the specified switches, they will be
/// ignored. `nullptr` will run browser process with no flags.
///
/// environment_created_handler is the handler result to the async operation
/// which will contain the WebView2Environment that got created.
///
/// The browserExecutableFolder, userDataFolder and additionalBrowserArguments
/// members of the environmentParams may be overridden by
/// values either specified in environment variables or in the registry.
///
/// When creating a WebView2Environment the following environment variables
/// are checked:
///
/// ```
/// WEBVIEW2_BROWSER_EXECUTABLE_FOLDER
/// WEBVIEW2_USER_DATA_FOLDER
/// WEBVIEW2_ADDITIONAL_BROWSER_ARGUMENTS
/// WEBVIEW2_RELEASE_CHANNEL_PREFERENCE
/// ```
///
/// If an override environment variable is found then we use the
/// browserExecutableFolder, userDataFolder and additionalBrowserArguments
/// values as replacements for the corresponding values in
/// CreateWebView2EnvironmentWithDetails parameters.
///
/// While not strictly overrides, there exists additional environment variables
/// that can be set:
///
/// ```
/// WEBVIEW2_WAIT_FOR_SCRIPT_DEBUGGER
/// ```
///
/// When found with a non-empty value, this indicates that the WebView is being
/// launched under a script debugger. In this case, the WebView will issue a
/// `Page.waitForDebugger` CDP command that will cause script execution inside the
/// WebView to pause on launch, until a debugger issues a corresponding
/// `Runtime.runIfWaitingForDebugger` CDP command to resume execution.
/// Note: There is no registry key equivalent of this environment variable.
///
/// ```
/// WEBVIEW2_PIPE_FOR_SCRIPT_DEBUGGER
/// ```
///
/// When found with a non-empty value, this indicates that the WebView is being
/// launched under a script debugger that also supports host applications that
/// use multiple WebViews. The value is used as the identifier for a named pipe
/// that will be opened and written to when a new WebView is created by the host
/// application. The payload will match that of the remote-debugging-port JSON
/// target and can be used by the external debugger to attach to a specific
/// WebView instance.
/// The format of the pipe created by the debugger should be:
/// `\\.\pipe\WebView2\Debugger\{app_name}\{pipe_name}`
/// where:
///
/// - `{app_name}` is the host application exe filename, e.g. WebView2Example.exe
/// - `{pipe_name}` is the value set for WEBVIEW2_PIPE_FOR_SCRIPT_DEBUGGER.
///
/// To enable debugging of the targets identified by the JSON you will also need
/// to set the WEBVIEW2_ADDITIONAL_BROWSER_ARGUMENTS environment variable to
/// send `--remote-debugging-port={port_num}`
/// where:
///
/// - `{port_num}` is the port on which the CDP server will bind.
///
/// Be aware that setting both the WEBVIEW2_PIPE_FOR_SCRIPT_DEBUGGER and
/// WEBVIEW2_ADDITIONAL_BROWSER_ARGUMENTS environment variables will cause the
/// WebViews hosted in your application and their contents to be exposed to
/// 3rd party applications such as debuggers.
///
/// Note: There is no registry key equivalent of this environment variable.
///
/// If none of those environment variables exist, then the registry is examined next.
/// The following registry keys are checked:
///
/// ```
/// [{Root}\Software\Policies\Microsoft\EmbeddedBrowserWebView\LoaderOverride\{AppId}]
/// "releaseChannelPreference"=dword:00000000
/// "browserExecutableFolder"=""
/// "userDataFolder"=""
/// "additionalBrowserArguments"=""
/// ```
///
/// In the unlikely scenario where some instances of WebView are open during
/// a browser update we could end up blocking the deletion of old Edge browsers.
/// To avoid running out of disk space a new WebView creation will fail
/// with the next error if it detects that there are many old versions present.
///
/// ```
/// ERROR_DISK_FULL
/// ```
///
/// The default maximum number of Edge versions allowed is 20.
///
/// The maximum number of old Edge versions allowed can be overwritten with the value
/// of the following environment variable.
///
/// ```
/// WEBVIEW2_MAX_INSTANCES
/// ```
///
/// If the Webview depends on an installed Edge and it is uninstalled
/// any subsequent creation will fail with the next error
///
/// ```
/// ERROR_PRODUCT_UNINSTALLED
/// ```
///
/// First we check with Root as HKLM and then HKCU.
/// AppId is first set to the Application User Model ID of the caller's process,
/// then if there's no corresponding registry key the AppId is
/// set to the executable name of the caller's process, or if that
/// isn't a registry key then '*'. If an override registry key is found then we
/// use the browserExecutableFolder, userDataFolder and additionalBrowserArguments
/// registry values as replacements for the corresponding values in
/// CreateWebView2EnvironmentWithDetails parameters. If any of those registry values
/// isn't present, then the parameter passed to CreateWebView2Environment is used.
cpp_quote("STDAPI CreateWebView2EnvironmentWithDetails(
    PCWSTR browserExecutableFolder,
    PCWSTR userDataFolder,
    PCWSTR additionalBrowserArguments,
    IWebView2CreateWebView2EnvironmentCompletedHandler* environment_created_handler);")

/// Creates an evergreen WebView2 Environment using the installed Edge version.
/// This is equivalent to calling CreateWebView2EnvironmentWithDetails with
/// nullptr for browserExecutableFolder, userDataFolder, additionalBrowserArguments.
///  See CreateWebView2EnvironmentWithDetails for more details.
cpp_quote("STDAPI CreateWebView2Environment(
    IWebView2CreateWebView2EnvironmentCompletedHandler* environment_created_handler);")

/// Get the browser version info including channel name if it is not the stable channel
/// or the Embedded Edge.
/// Channel names are beta, dev, and canary.
/// If an override exists for the browserExecutableFolder or the channel preference,
/// the override will be used.
/// If there isn't an override, then the parameter passed to GetWebView2BrowserVersionInfo is used.
cpp_quote("STDAPI GetWebView2BrowserVersionInfo(
    PCWSTR browserExecutableFolder,
    LPWSTR* versionInfo);")

/// This method is for anyone want to compare version correctly to determine
/// which version is newer, older or same. It can be used to determine whether
/// to use webview2 or certain feature base on version.
/// Sets the value of result to -1, 0 or 1 if version1 is less than, equal or
/// greater than version2 respectively.
/// Returns E_INVALIDARG if it fails to parse any of the version strings or any
/// input parameter is null.
/// Input can directly use the versionInfo obtained from GetWebView2BrowserVersionInfo,
/// channel info will be ignored.
cpp_quote("STDAPI CompareBrowserVersions(
    PCWSTR version1,
    PCWSTR version2,
    int* result);")
